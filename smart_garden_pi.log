2025-09-03 23:16:16,770 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-03 23:16:16,770 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.73:8080
2025-09-03 23:16:16,770 - controller.run_pi_client - INFO - Family Code: IRIS12
2025-09-03 23:16:16,770 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-03 23:16:16,770 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-03 23:16:16,772 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-03 23:16:16,772 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-03 23:16:16,773 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-03 23:16:16,773 - controller.run_pi_client - INFO - Family code configured: IRIS12
2025-09-03 23:16:16,773 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-03 23:16:16,773 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-03 23:16:16,773 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-03 23:16:16,773 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-03 23:16:16,863 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - Message data values: None
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:16:16,864 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-03 23:16:17,877 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-03 23:16:17,877 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-03 23:16:17,877 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-03 23:16:17,877 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-03 23:16:17,877 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:16:17,879 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-03 23:16:17,879 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-03 23:16:17,879 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:16:17,879 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-03 23:16:17,879 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-03 23:16:17,879 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:16:17,880 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-03 23:16:17,880 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-03 23:16:17,880 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-03 23:16:18,875 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-03 23:16:18,928 - controller.services.websocket_client - INFO - Supported commands:
2025-09-03 23:16:18,932 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-03 23:16:18,933 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-03 23:16:18,933 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-03 23:16:18,934 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-03 23:16:18,934 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-03 23:16:18,934 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-03 23:16:18,934 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-03 23:16:18,935 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-03 23:16:18,935 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-03 23:16:18,935 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-03 23:16:18,935 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-03 23:16:18,936 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-03 23:16:18,936 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-03 23:16:18,936 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-03 23:16:18,937 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-03 23:16:18,937 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:16:18,937 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-03 23:16:18,938 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-03 23:16:18,939 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-03 23:16:18,940 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:16:18,950 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-03 23:16:18,954 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:16:18,956 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-03 23:16:18,959 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:16:18,959 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-03 23:16:18,961 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-03 23:16:18,962 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-03 23:16:18,963 - controller.services.websocket_client - INFO - Total plants in engine: 0
2025-09-03 23:16:18,963 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:16:18,963 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-03 23:16:18,963 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-03 23:16:18,963 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:16:18,963 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:16:18,963 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:16:18,963 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:16:18,965 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:16:18,965 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:16:18,965 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:16:38,052 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-03 23:16:38,053 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-03 23:16:38,053 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-03 23:16:38,053 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-03 23:16:38,055 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:16:38,116 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-03 23:16:38,116 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-03 23:16:38,116 - controller.handlers.get_all_plants_moisture_handler - WARNING - No plants found or all sensor readings failed
2025-09-03 23:16:38,117 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:16:38,118 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-03 23:16:38,118 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756930598.1178885}}
2025-09-03 23:16:38,118 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:16:38,118 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-03 23:16:38,119 - controller.services.websocket_client - INFO - Message data values: {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756930598.1178885}
2025-09-03 23:16:38,119 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:16:38,119 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-03 23:16:38,120 - controller.services.websocket_client - ERROR - Failed to get moisture for all plants: No plants found or all sensor readings failed
2025-09-03 23:16:52,734 - controller.services.websocket_client - INFO - Received ADD_PLANT message
2025-09-03 23:16:52,735 - controller.services.websocket_client - INFO - Full message: {"type":"ADD_PLANT","data":{"plant_id":215,"desiredMoisture":60,"waterLimit":1,"dripperType":"2L/h","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"23:16:00"}}}
2025-09-03 23:16:52,736 - controller.services.websocket_client - INFO - Parsed data: {'type': 'ADD_PLANT', 'data': {'plant_id': 215, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}}
2025-09-03 23:16:52,736 - controller.services.websocket_client - INFO - Message type: 'ADD_PLANT' (length: 9)
2025-09-03 23:16:52,736 - controller.services.websocket_client - INFO - Message data: {'plant_id': 215, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:16:52,737 - controller.services.websocket_client - INFO - Received ADD_PLANT command from server
2025-09-03 23:16:52,737 - controller.services.websocket_client - INFO - Full message: {'plant_id': 215, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:16:52,737 - controller.services.websocket_client - INFO - Parsed data: {'plant_id': 215, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:16:52,738 - controller.services.websocket_client - INFO - Plant ID: 215
2025-09-03 23:16:52,738 - controller.services.websocket_client - INFO - Desired Moisture: 60
2025-09-03 23:16:52,738 - controller.services.websocket_client - INFO - Water Limit: 1
2025-09-03 23:16:52,740 - controller.handlers.add_plant_handler - INFO - Received add plant message from server: {'plant_id': 215, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:16:52,740 - controller.handlers.add_plant_handler - INFO - Message type: <class 'dict'>
2025-09-03 23:16:52,740 - controller.handlers.add_plant_handler - INFO - Available keys: ['plant_id', 'desiredMoisture', 'waterLimit', 'dripperType', 'lat', 'lon', 'scheduleData']
2025-09-03 23:16:52,741 - controller.handlers.add_plant_handler - INFO - Using plant_id 215 directly from server
2025-09-03 23:16:52,742 - controller.services.websocket_client - INFO - === ADD_PLANT RESPONSE DEBUG ===
2025-09-03 23:16:52,742 - controller.services.websocket_client - INFO - Response success: True
2025-09-03 23:16:52,742 - controller.services.websocket_client - INFO - Response DTO: plant_id=215 status='success' desired_moisture=60.0 assigned_valve=1 sensor_port='/dev/ttyUSB0' error_message=None timestamp=1756930612.7423866
2025-09-03 23:16:52,743 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:16:52,743 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 215, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 1, 'sensor_port': '/dev/ttyUSB0', 'error_message': None, 'timestamp': 1756930612.7423866}
2025-09-03 23:16:52,743 - controller.services.websocket_client - INFO - ================================
2025-09-03 23:16:52,744 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:16:52,744 - controller.services.websocket_client - INFO - Message type: ADD_PLANT_RESPONSE
2025-09-03 23:16:52,744 - controller.services.websocket_client - INFO - Full message: {'type': 'ADD_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 215, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 1, 'sensor_port': '/dev/ttyUSB0', 'error_message': None, 'timestamp': 1756930612.7423866}}
2025-09-03 23:16:52,744 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:16:52,746 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:16:52,746 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 215, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 1, 'sensor_port': '/dev/ttyUSB0', 'error_message': None, 'timestamp': 1756930612.7423866}
2025-09-03 23:16:52,746 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:16:52,747 - controller.services.websocket_client - INFO - Sent ADD_PLANT_RESPONSE message
2025-09-03 23:16:52,747 - controller.services.websocket_client - INFO - Successfully processed ADD_PLANT command
2025-09-03 23:16:52,764 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:16:52,764 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: ADD_PLANT_RESPONSE"}
2025-09-03 23:16:52,766 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: ADD_PLANT_RESPONSE'}
2025-09-03 23:16:52,766 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:16:52,766 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:16:52,767 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:16:52,767 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:16:52,768 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:16:52,768 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:16:52,768 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:17:41,123 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-03 23:17:41,124 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-03 23:17:41,124 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-03 23:17:46,131 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-03 23:17:46,131 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-03 23:17:46,131 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-03 23:17:46,132 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-03 23:17:46,136 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-03 23:17:46,136 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:17:46,136 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-03 23:17:46,136 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-03 23:17:46,137 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-03 23:17:46,137 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-03 23:17:46,137 - controller.services.websocket_client - INFO - Message data values: None
2025-09-03 23:17:46,138 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:17:46,138 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-03 23:17:47,144 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-03 23:17:47,146 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:17:47,146 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-03 23:17:47,146 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-03 23:17:47,146 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:17:47,146 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-03 23:17:47,147 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-03 23:17:47,147 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-03 23:17:48,154 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-03 23:17:48,154 - controller.services.websocket_client - INFO - Supported commands:
2025-09-03 23:17:48,154 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-03 23:17:48,154 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-03 23:17:48,154 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-03 23:17:48,155 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-03 23:17:48,156 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-03 23:17:48,156 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-03 23:17:48,156 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-03 23:17:48,157 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-03 23:17:48,157 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-03 23:17:48,157 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:17:48,157 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-03 23:17:48,157 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO -   - Plant 215: 60.0% target moisture
2025-09-03 23:17:48,159 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:17:48,161 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-03 23:17:48,161 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-03 23:17:48,161 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:17:48,161 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:17:48,161 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:17:48,161 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:17:48,161 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:17:48,161 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:17:48,162 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:17:54,788 - controller.services.websocket_client - INFO - Received ADD_PLANT message
2025-09-03 23:17:54,788 - controller.services.websocket_client - INFO - Full message: {"type":"ADD_PLANT","data":{"plant_id":216,"desiredMoisture":60,"waterLimit":1,"dripperType":"2L/h","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"23:16:00"}}}
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Parsed data: {'type': 'ADD_PLANT', 'data': {'plant_id': 216, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}}
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Message type: 'ADD_PLANT' (length: 9)
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Message data: {'plant_id': 216, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Received ADD_PLANT command from server
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Full message: {'plant_id': 216, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Parsed data: {'plant_id': 216, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:17:54,790 - controller.services.websocket_client - INFO - Plant ID: 216
2025-09-03 23:17:54,791 - controller.services.websocket_client - INFO - Desired Moisture: 60
2025-09-03 23:17:54,791 - controller.services.websocket_client - INFO - Water Limit: 1
2025-09-03 23:17:54,791 - controller.handlers.add_plant_handler - INFO - Received add plant message from server: {'plant_id': 216, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:17:54,791 - controller.handlers.add_plant_handler - INFO - Message type: <class 'dict'>
2025-09-03 23:17:54,791 - controller.handlers.add_plant_handler - INFO - Available keys: ['plant_id', 'desiredMoisture', 'waterLimit', 'dripperType', 'lat', 'lon', 'scheduleData']
2025-09-03 23:17:54,791 - controller.handlers.add_plant_handler - INFO - Using plant_id 216 directly from server
2025-09-03 23:17:54,791 - controller.services.websocket_client - INFO - === ADD_PLANT RESPONSE DEBUG ===
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Response success: True
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Response DTO: plant_id=216 status='success' desired_moisture=60.0 assigned_valve=2 sensor_port='/dev/ttyUSB1' error_message=None timestamp=1756930674.7911236
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 216, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 2, 'sensor_port': '/dev/ttyUSB1', 'error_message': None, 'timestamp': 1756930674.7911236}
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - ================================
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Message type: ADD_PLANT_RESPONSE
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Full message: {'type': 'ADD_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 216, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 2, 'sensor_port': '/dev/ttyUSB1', 'error_message': None, 'timestamp': 1756930674.7911236}}
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:17:54,792 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:17:54,793 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 216, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 2, 'sensor_port': '/dev/ttyUSB1', 'error_message': None, 'timestamp': 1756930674.7911236}
2025-09-03 23:17:54,793 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:17:54,793 - controller.services.websocket_client - INFO - Sent ADD_PLANT_RESPONSE message
2025-09-03 23:17:54,793 - controller.services.websocket_client - INFO - Successfully processed ADD_PLANT command
2025-09-03 23:17:54,881 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:17:54,881 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: ADD_PLANT_RESPONSE"}
2025-09-03 23:17:54,881 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: ADD_PLANT_RESPONSE'}
2025-09-03 23:17:54,881 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:17:54,882 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:17:54,882 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:17:54,882 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:17:54,882 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:17:54,883 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:17:54,883 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:19:11,139 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-03 23:19:11,142 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-03 23:19:11,142 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-03 23:19:16,148 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-03 23:19:16,149 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-03 23:19:16,149 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-03 23:19:16,149 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-03 23:19:16,151 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-03 23:19:16,151 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:19:16,151 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-03 23:19:16,151 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-03 23:19:16,153 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-03 23:19:16,153 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-03 23:19:16,153 - controller.services.websocket_client - INFO - Message data values: None
2025-09-03 23:19:16,153 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:19:16,153 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-03 23:19:17,164 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-03 23:19:17,164 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-03 23:19:17,164 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-03 23:19:17,164 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-03 23:19:17,164 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:19:17,166 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-03 23:19:17,167 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-03 23:19:17,167 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-03 23:19:18,160 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-03 23:19:18,161 - controller.services.websocket_client - INFO - Supported commands:
2025-09-03 23:19:18,161 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-03 23:19:18,161 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-03 23:19:18,161 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-03 23:19:18,161 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-03 23:19:18,163 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-03 23:19:18,164 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-03 23:19:18,164 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-03 23:19:18,164 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-03 23:19:18,164 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-03 23:19:18,164 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:19:18,166 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-03 23:19:18,166 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-03 23:19:18,166 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-03 23:19:18,166 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:19:18,166 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-03 23:19:18,167 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:19:18,167 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-03 23:19:18,167 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:19:18,167 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO -   - Plant 215: 60.0% target moisture
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO -   - Plant 216: 60.0% target moisture
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:19:18,168 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:19:18,168 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:19:18,170 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:19:18,170 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:19:18,170 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:19:18,170 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:19:25,223 - controller.services.websocket_client - INFO - Received ADD_PLANT message
2025-09-03 23:19:25,225 - controller.services.websocket_client - INFO - Full message: {"type":"ADD_PLANT","data":{"plant_id":217,"desiredMoisture":60,"waterLimit":1,"dripperType":"2L/h","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"23:16:00"}}}
2025-09-03 23:19:25,225 - controller.services.websocket_client - INFO - Parsed data: {'type': 'ADD_PLANT', 'data': {'plant_id': 217, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}}
2025-09-03 23:19:25,225 - controller.services.websocket_client - INFO - Message type: 'ADD_PLANT' (length: 9)
2025-09-03 23:19:25,227 - controller.services.websocket_client - INFO - Message data: {'plant_id': 217, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:19:25,227 - controller.services.websocket_client - INFO - Received ADD_PLANT command from server
2025-09-03 23:19:25,227 - controller.services.websocket_client - INFO - Full message: {'plant_id': 217, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:19:25,229 - controller.services.websocket_client - INFO - Parsed data: {'plant_id': 217, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:19:25,229 - controller.services.websocket_client - INFO - Plant ID: 217
2025-09-03 23:19:25,229 - controller.services.websocket_client - INFO - Desired Moisture: 60
2025-09-03 23:19:25,229 - controller.services.websocket_client - INFO - Water Limit: 1
2025-09-03 23:19:25,229 - controller.handlers.add_plant_handler - INFO - Received add plant message from server: {'plant_id': 217, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:16:00'}}
2025-09-03 23:19:25,229 - controller.handlers.add_plant_handler - INFO - Message type: <class 'dict'>
2025-09-03 23:19:25,234 - controller.handlers.add_plant_handler - INFO - Available keys: ['plant_id', 'desiredMoisture', 'waterLimit', 'dripperType', 'lat', 'lon', 'scheduleData']
2025-09-03 23:19:25,234 - controller.handlers.add_plant_handler - INFO - Using plant_id 217 directly from server
2025-09-03 23:19:25,235 - controller.handlers.add_plant_handler - ERROR - Unexpected error in add plant handler: No available valves
2025-09-03 23:19:25,235 - controller.services.websocket_client - INFO - === ADD_PLANT RESPONSE DEBUG ===
2025-09-03 23:19:25,235 - controller.services.websocket_client - INFO - Response success: False
2025-09-03 23:19:25,235 - controller.services.websocket_client - INFO - Response DTO: plant_id=217 status='error' desired_moisture=0.0 assigned_valve=None sensor_port=None error_message='Unexpected error: No available valves' timestamp=1756930765.2352724
2025-09-03 23:19:25,238 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:19:25,238 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 217, 'status': 'error', 'desired_moisture': 0.0, 'assigned_valve': None, 'sensor_port': None, 'error_message': 'Unexpected error: No available valves', 'timestamp': 1756930765.2352724}
2025-09-03 23:19:25,239 - controller.services.websocket_client - INFO - ================================
2025-09-03 23:19:25,239 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:19:25,239 - controller.services.websocket_client - INFO - Message type: ADD_PLANT_RESPONSE
2025-09-03 23:19:25,242 - controller.services.websocket_client - INFO - Full message: {'type': 'ADD_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 217, 'status': 'error', 'desired_moisture': 0.0, 'assigned_valve': None, 'sensor_port': None, 'error_message': 'Unexpected error: No available valves', 'timestamp': 1756930765.2352724}}
2025-09-03 23:19:25,242 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:19:25,242 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:19:25,242 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 217, 'status': 'error', 'desired_moisture': 0.0, 'assigned_valve': None, 'sensor_port': None, 'error_message': 'Unexpected error: No available valves', 'timestamp': 1756930765.2352724}
2025-09-03 23:19:25,242 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:19:25,246 - controller.services.websocket_client - INFO - Sent ADD_PLANT_RESPONSE message
2025-09-03 23:19:25,246 - controller.services.websocket_client - ERROR - Failed to process ADD_PLANT command: Unexpected error: No available valves
2025-09-03 23:19:25,248 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:19:25,248 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: ADD_PLANT_RESPONSE"}
2025-09-03 23:19:25,248 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: ADD_PLANT_RESPONSE'}
2025-09-03 23:19:25,248 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:19:25,248 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:19:25,248 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:19:25,248 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:19:25,248 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:19:25,254 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:19:25,254 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:19:45,149 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-03 23:19:45,151 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-03 23:19:45,151 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-03 23:19:45,151 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-03 23:19:45,151 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:19:45,151 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-03 23:19:45,151 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-03 23:19:45,153 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 215): moisture=30.0%, temperature=None
2025-09-03 23:19:45,155 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 216): moisture=30.0%, temperature=None
2025-09-03 23:19:45,155 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-03 23:19:45,155 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:19:45,155 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-03 23:19:45,155 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 215, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756930785.153897}, {'event': 'all_plants_moisture_update', 'plant_id': 216, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756930785.155411}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756930785.155411}}
2025-09-03 23:19:45,160 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:19:45,160 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-03 23:19:45,160 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 215, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756930785.153897}, {'event': 'all_plants_moisture_update', 'plant_id': 216, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756930785.155411}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756930785.155411}
2025-09-03 23:19:45,162 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:19:45,163 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-03 23:19:45,164 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-03 23:19:55,154 - controller.services.websocket_client - INFO - Received ADD_PLANT message
2025-09-03 23:19:55,154 - controller.services.websocket_client - INFO - Full message: {"type":"ADD_PLANT","data":{"plant_id":218,"desiredMoisture":60,"waterLimit":1,"dripperType":"1L/h","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"23:19:00"}}}
2025-09-03 23:19:55,159 - controller.services.websocket_client - INFO - Parsed data: {'type': 'ADD_PLANT', 'data': {'plant_id': 218, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '1L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:19:00'}}}
2025-09-03 23:19:55,160 - controller.services.websocket_client - INFO - Message type: 'ADD_PLANT' (length: 9)
2025-09-03 23:19:55,160 - controller.services.websocket_client - INFO - Message data: {'plant_id': 218, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '1L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:19:00'}}
2025-09-03 23:19:55,161 - controller.services.websocket_client - INFO - Received ADD_PLANT command from server
2025-09-03 23:19:55,161 - controller.services.websocket_client - INFO - Full message: {'plant_id': 218, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '1L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:19:00'}}
2025-09-03 23:19:55,161 - controller.services.websocket_client - INFO - Parsed data: {'plant_id': 218, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '1L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:19:00'}}
2025-09-03 23:19:55,161 - controller.services.websocket_client - INFO - Plant ID: 218
2025-09-03 23:19:55,161 - controller.services.websocket_client - INFO - Desired Moisture: 60
2025-09-03 23:19:55,161 - controller.services.websocket_client - INFO - Water Limit: 1
2025-09-03 23:19:55,161 - controller.handlers.add_plant_handler - INFO - Received add plant message from server: {'plant_id': 218, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '1L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '23:19:00'}}
2025-09-03 23:19:55,161 - controller.handlers.add_plant_handler - INFO - Message type: <class 'dict'>
2025-09-03 23:19:55,161 - controller.handlers.add_plant_handler - INFO - Available keys: ['plant_id', 'desiredMoisture', 'waterLimit', 'dripperType', 'lat', 'lon', 'scheduleData']
2025-09-03 23:19:55,161 - controller.handlers.add_plant_handler - INFO - Using plant_id 218 directly from server
2025-09-03 23:19:55,168 - controller.handlers.add_plant_handler - ERROR - Unexpected error in add plant handler: No available valves
2025-09-03 23:19:55,168 - controller.services.websocket_client - INFO - === ADD_PLANT RESPONSE DEBUG ===
2025-09-03 23:19:55,170 - controller.services.websocket_client - INFO - Response success: False
2025-09-03 23:19:55,170 - controller.services.websocket_client - INFO - Response DTO: plant_id=218 status='error' desired_moisture=0.0 assigned_valve=None sensor_port=None error_message='Unexpected error: No available valves' timestamp=1756930795.168338
2025-09-03 23:19:55,172 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:19:55,172 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 218, 'status': 'error', 'desired_moisture': 0.0, 'assigned_valve': None, 'sensor_port': None, 'error_message': 'Unexpected error: No available valves', 'timestamp': 1756930795.168338}
2025-09-03 23:19:55,172 - controller.services.websocket_client - INFO - ================================
2025-09-03 23:19:55,174 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:19:55,174 - controller.services.websocket_client - INFO - Message type: ADD_PLANT_RESPONSE
2025-09-03 23:19:55,176 - controller.services.websocket_client - INFO - Full message: {'type': 'ADD_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 218, 'status': 'error', 'desired_moisture': 0.0, 'assigned_valve': None, 'sensor_port': None, 'error_message': 'Unexpected error: No available valves', 'timestamp': 1756930795.168338}}
2025-09-03 23:19:55,176 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:19:55,177 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-03 23:19:55,177 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 218, 'status': 'error', 'desired_moisture': 0.0, 'assigned_valve': None, 'sensor_port': None, 'error_message': 'Unexpected error: No available valves', 'timestamp': 1756930795.168338}
2025-09-03 23:19:55,177 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:19:55,177 - controller.services.websocket_client - INFO - Sent ADD_PLANT_RESPONSE message
2025-09-03 23:19:55,177 - controller.services.websocket_client - ERROR - Failed to process ADD_PLANT command: Unexpected error: No available valves
2025-09-03 23:19:55,177 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:19:55,182 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: ADD_PLANT_RESPONSE"}
2025-09-03 23:19:55,182 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: ADD_PLANT_RESPONSE'}
2025-09-03 23:19:55,182 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:19:55,182 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:19:55,182 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:19:55,184 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:19:55,186 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:19:55,186 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:19:55,186 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:20:41,151 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-03 23:20:41,153 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-03 23:20:41,153 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-03 23:20:46,160 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-03 23:20:46,160 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-03 23:20:46,162 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-03 23:20:46,162 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-03 23:20:46,169 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-03 23:20:46,170 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:20:46,170 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-03 23:20:46,170 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-03 23:20:46,172 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-03 23:20:46,172 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-03 23:20:46,172 - controller.services.websocket_client - INFO - Message data values: None
2025-09-03 23:20:46,172 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:20:46,172 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-03 23:20:47,180 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-03 23:20:47,180 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-03 23:20:47,180 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-03 23:20:47,183 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-03 23:20:47,183 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:20:47,183 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-03 23:20:47,184 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-03 23:20:47,184 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:20:47,185 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-03 23:20:47,186 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-03 23:20:47,186 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:20:47,187 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-03 23:20:47,187 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-03 23:20:47,187 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO - Supported commands:
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-03 23:20:48,192 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-03 23:20:48,194 - controller.services.websocket_client - INFO -   - Plant 215: 60.0% target moisture
2025-09-03 23:20:48,199 - controller.services.websocket_client - INFO -   - Plant 216: 60.0% target moisture
2025-09-03 23:20:48,199 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:20:48,199 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-03 23:20:48,199 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-03 23:20:48,199 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:20:48,199 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:20:48,199 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:20:48,199 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:20:48,200 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:20:48,200 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:20:48,200 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:22:11,160 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-03 23:22:11,161 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-03 23:22:11,161 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-03 23:22:16,173 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-03 23:22:16,174 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-03 23:22:16,175 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-03 23:22:16,176 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-03 23:22:16,181 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-03 23:22:16,181 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:22:16,185 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-03 23:22:16,185 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-03 23:22:16,185 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-03 23:22:16,185 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-03 23:22:16,185 - controller.services.websocket_client - INFO - Message data values: None
2025-09-03 23:22:16,185 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:22:16,189 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-03 23:22:17,194 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-03 23:22:17,194 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-03 23:22:17,194 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - =============================
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-03 23:22:17,195 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-03 23:22:17,199 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-03 23:22:18,196 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-03 23:22:18,197 - controller.services.websocket_client - INFO - Supported commands:
2025-09-03 23:22:18,197 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-03 23:22:18,197 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-03 23:22:18,197 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-03 23:22:18,197 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-03 23:22:18,201 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-03 23:22:18,204 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-03 23:22:18,205 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-03 23:22:18,206 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-03 23:22:18,214 - controller.services.websocket_client - INFO -   - Plant 215: 60.0% target moisture
2025-09-03 23:22:18,214 - controller.services.websocket_client - INFO -   - Plant 216: 60.0% target moisture
2025-09-03 23:22:18,214 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-03 23:22:18,215 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-03 23:22:18,215 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-03 23:22:18,215 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-03 23:22:18,215 - controller.services.websocket_client - INFO - Message data: {}
2025-09-03 23:22:18,218 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-03 23:22:18,218 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-03 23:22:18,218 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-03 23:22:18,218 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-03 23:22:18,218 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-03 23:23:55,024 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-03 23:23:55,028 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-03 23:23:55,029 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 01:46:17,981 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 01:46:18,002 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 01:46:18,018 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 01:46:18,039 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 01:46:18,248 - controller.services.websocket_client - ERROR - Failed to connect: [WinError 1232] The network location cannot be reached. For information about network troubleshooting, see Windows Help
2025-09-04 01:46:18,252 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 01:46:23,267 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 01:46:23,267 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 01:46:23,267 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 01:46:23,267 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 01:46:23,267 - controller.services.websocket_client - ERROR - Failed to connect: [WinError 1232] The network location cannot be reached. For information about network troubleshooting, see Windows Help
2025-09-04 01:46:23,267 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 01:46:28,283 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 01:46:28,283 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 01:46:28,284 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 01:46:28,284 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 01:46:28,286 - controller.services.websocket_client - ERROR - Failed to connect: [WinError 1232] The network location cannot be reached. For information about network troubleshooting, see Windows Help
2025-09-04 01:46:28,286 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:18:59,261 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:18:59,288 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:18:59,322 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:18:59,334 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:18:59,364 - controller.services.websocket_client - ERROR - Failed to connect: [WinError 1232] The network location cannot be reached. For information about network troubleshooting, see Windows Help
2025-09-04 12:18:59,407 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:19:04,643 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:19:04,648 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:19:04,652 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:19:04,667 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:19:07,341 - controller.services.websocket_client - ERROR - Failed to connect: [WinError 1225] The remote computer refused the network connection
2025-09-04 12:19:07,350 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:19:12,369 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:19:12,373 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:19:12,377 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:19:12,379 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:19:22,403 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:19:22,406 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:19:27,418 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:19:27,419 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:19:27,419 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:19:27,419 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:19:37,430 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:19:37,432 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:19:42,441 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:19:42,441 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:19:42,441 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:19:42,441 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:19:52,457 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:19:52,458 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:19:57,471 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:19:57,471 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:19:57,471 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:19:57,472 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:20:07,480 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:20:07,480 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:20:12,484 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:20:12,484 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:20:12,485 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:20:12,485 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:20:22,489 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:20:22,490 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:20:27,504 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:20:27,504 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:20:27,504 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:20:27,505 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:20:37,513 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:20:37,513 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:20:42,516 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:20:42,516 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:20:42,516 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:20:42,516 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:20:52,535 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:20:52,537 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:20:57,548 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:20:57,552 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:20:57,553 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:20:57,553 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:21:07,566 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:21:07,566 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:21:12,580 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:21:12,581 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:21:12,581 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:21:12,582 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:21:19,336 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 12:21:19,373 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:21:19,374 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:21:22,582 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:21:22,583 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:21:22,584 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:21:58,040 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-04 12:21:58,041 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.73:8080
2025-09-04 12:21:58,041 - controller.run_pi_client - INFO - Family Code: IRIS12
2025-09-04 12:21:58,041 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-04 12:21:58,041 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-04 12:21:58,041 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-04 12:21:58,041 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-04 12:21:58,043 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-04 12:21:58,045 - controller.run_pi_client - INFO - Family code configured: IRIS12
2025-09-04 12:21:58,045 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:21:58,046 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:21:58,046 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:21:58,046 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:22:08,103 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:22:08,103 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:22:13,115 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:22:13,115 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:22:13,115 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:22:13,116 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:22:23,125 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:22:23,125 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:22:28,138 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:22:28,139 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:22:28,139 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:22:28,140 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:22:31,644 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 12:22:31,645 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:22:31,645 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:22:38,146 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:22:38,146 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:22:38,146 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:23:20,670 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-04 12:23:20,670 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.73:8080
2025-09-04 12:23:20,670 - controller.run_pi_client - INFO - Family Code: IRIS12
2025-09-04 12:23:20,671 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-04 12:23:20,671 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-04 12:23:20,671 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-04 12:23:20,671 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-04 12:23:20,672 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-04 12:23:20,672 - controller.run_pi_client - INFO - Family code configured: IRIS12
2025-09-04 12:23:20,672 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:23:20,672 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:23:20,673 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:23:20,673 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:23:30,701 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:23:30,702 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:23:35,707 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:23:35,708 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:23:35,708 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:23:35,708 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:23:45,711 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:23:45,712 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:23:50,719 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:23:50,719 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:23:50,719 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:23:50,719 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.73:8080
2025-09-04 12:23:54,681 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 12:23:54,683 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:23:54,683 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:24:00,725 - controller.services.websocket_client - ERROR - Failed to connect: timed out during opening handshake
2025-09-04 12:24:00,726 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:24:00,726 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:26:17,370 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-04 12:26:17,370 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.67:8080
2025-09-04 12:26:17,370 - controller.run_pi_client - INFO - Family Code: IRIS12
2025-09-04 12:26:17,370 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-04 12:26:17,370 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-04 12:26:17,371 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-04 12:26:17,371 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-04 12:26:17,372 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-04 12:26:17,372 - controller.run_pi_client - INFO - Family code configured: IRIS12
2025-09-04 12:26:17,373 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:26:17,373 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:26:17,373 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:26:17,373 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:26:17,432 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:26:17,432 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:26:17,432 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:26:17,432 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:26:17,433 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:26:17,433 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:26:17,433 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:26:17,433 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:26:17,434 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:26:18,437 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:26:18,437 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:26:18,437 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:26:18,438 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:26:18,438 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:26:18,438 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:26:18,439 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:26:18,439 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:26:18,439 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:26:18,440 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:26:18,440 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:26:18,440 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:26:18,440 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:26:18,442 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:26:19,442 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:26:19,443 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:26:19,443 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:26:19,444 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:26:19,444 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:26:19,444 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:26:19,445 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:26:19,446 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:26:19,446 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:26:19,446 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:26:19,447 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:26:19,447 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:26:19,447 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:26:19,448 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:26:19,448 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:26:19,448 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:26:19,449 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:26:19,449 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:26:19,449 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:26:19,450 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:26:19,450 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-04 12:26:19,450 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-04 12:26:19,450 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:26:19,451 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:26:19,451 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:26:19,451 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-04 12:26:19,453 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:26:19,453 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-04 12:26:19,453 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:26:19,453 - controller.services.websocket_client - INFO - Total plants in engine: 0
2025-09-04 12:26:19,453 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:26:19,453 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:26:19,455 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:26:19,455 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:26:19,455 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:26:19,455 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:26:19,455 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:26:19,456 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:26:19,456 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:26:19,456 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:27:34,770 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:27:34,904 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:27:34,918 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:27:39,940 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:27:39,941 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:27:39,946 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:27:39,947 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:27:40,055 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:27:40,063 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:27:40,066 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:27:40,067 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:27:40,067 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:27:40,067 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:27:40,067 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:27:40,068 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:27:40,071 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:27:41,081 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:27:41,133 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:27:41,181 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:27:41,187 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:27:41,265 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:27:41,281 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:27:41,286 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:27:41,287 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:27:41,288 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:27:41,314 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:27:41,364 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:27:41,388 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:27:41,391 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:27:41,397 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:27:42,410 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:27:42,419 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:27:42,423 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:27:42,424 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:27:42,437 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:27:42,437 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:27:42,437 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:27:42,453 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:27:42,473 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:27:42,474 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:27:42,474 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:27:42,518 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:27:42,551 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:27:42,559 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:27:42,559 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:27:42,562 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:27:42,563 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:27:42,571 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:27:42,572 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:27:42,574 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:27:42,630 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-04 12:27:42,657 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-04 12:27:42,685 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:27:42,696 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:27:42,769 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:27:42,790 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-04 12:27:42,792 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:27:42,801 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-04 12:27:42,806 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:27:42,808 - controller.services.websocket_client - INFO - Total plants in engine: 0
2025-09-04 12:27:42,821 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:27:42,822 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:27:42,822 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:27:42,823 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:27:42,823 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:27:42,872 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:27:42,885 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:27:42,887 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:27:42,922 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:27:42,923 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:28:21,652 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:28:21,652 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:28:21,653 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:28:21,653 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:28:21,653 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:28:21,750 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:28:21,750 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:28:21,750 - controller.handlers.get_all_plants_moisture_handler - WARNING - No plants found or all sensor readings failed
2025-09-04 12:28:21,753 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:28:21,753 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:28:21,753 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756978101.7509415}}
2025-09-04 12:28:21,754 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:28:21,754 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:28:21,754 - controller.services.websocket_client - INFO - Message data values: {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756978101.7509415}
2025-09-04 12:28:21,754 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:28:21,755 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:28:21,755 - controller.services.websocket_client - ERROR - Failed to get moisture for all plants: No plants found or all sensor readings failed
2025-09-04 12:28:34,951 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:28:34,952 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:28:34,952 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:28:34,952 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:28:34,953 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:28:34,953 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:28:34,953 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:28:34,954 - controller.handlers.get_all_plants_moisture_handler - WARNING - No plants found or all sensor readings failed
2025-09-04 12:28:34,954 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:28:34,956 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:28:34,956 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756978114.9549942}}
2025-09-04 12:28:34,956 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:28:34,957 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:28:34,958 - controller.services.websocket_client - INFO - Message data values: {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756978114.9549942}
2025-09-04 12:28:34,959 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:28:34,959 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:28:34,961 - controller.services.websocket_client - ERROR - Failed to get moisture for all plants: No plants found or all sensor readings failed
2025-09-04 12:28:44,668 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:28:44,669 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:28:44,669 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:28:44,669 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:28:44,669 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:28:44,669 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:28:44,669 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:28:44,669 - controller.handlers.get_all_plants_moisture_handler - WARNING - No plants found or all sensor readings failed
2025-09-04 12:28:44,669 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756978124.6693816}}
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - Message data values: {'plants': [], 'total_plants': 0, 'status': 'error', 'error_message': 'No plants found or all sensor readings failed', 'timestamp': 1756978124.6693816}
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:28:44,670 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:28:44,670 - controller.services.websocket_client - ERROR - Failed to get moisture for all plants: No plants found or all sensor readings failed
2025-09-04 12:29:04,746 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:29:04,747 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:29:04,748 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:29:09,750 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:29:09,751 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:29:09,751 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:29:09,752 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:29:09,755 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:29:09,756 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:09,756 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:29:09,757 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:29:09,757 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:29:09,758 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:29:09,758 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:29:09,759 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:09,759 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:29:10,765 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:29:10,765 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:29:10,766 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:29:10,767 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:29:10,767 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:10,769 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:29:10,769 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:29:10,769 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:10,770 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:29:10,770 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:29:10,771 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:10,772 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:29:10,772 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:29:10,773 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:29:11,788 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:29:11,788 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:29:11,788 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:29:11,788 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:29:11,790 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:29:11,790 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:29:11,790 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:29:11,791 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:29:11,791 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:29:11,791 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:29:11,791 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:29:11,791 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:29:11,792 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:29:11,792 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:29:11,792 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:29:11,792 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:29:11,792 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:29:11,793 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:11,793 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:29:11,793 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:29:11,793 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[]}
2025-09-04 12:29:11,793 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-04 12:29:11,793 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:29:11,794 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:11,794 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:29:11,794 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': []}
2025-09-04 12:29:11,794 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:29:11,794 - controller.services.websocket_client - INFO - Plants to sync: 0
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - Total plants in engine: 0
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:29:11,795 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:11,795 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:29:11,796 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:29:11,796 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:29:11,796 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:29:11,796 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:29:27,805 - controller.services.websocket_client - INFO - Received ADD_PLANT message
2025-09-04 12:29:27,806 - controller.services.websocket_client - INFO - Full message: {"type":"ADD_PLANT","data":{"plant_id":219,"desiredMoisture":60,"waterLimit":1,"dripperType":"2L/h","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}}
2025-09-04 12:29:27,806 - controller.services.websocket_client - INFO - Parsed data: {'type': 'ADD_PLANT', 'data': {'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}}
2025-09-04 12:29:27,806 - controller.services.websocket_client - INFO - Message type: 'ADD_PLANT' (length: 9)
2025-09-04 12:29:27,806 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}
2025-09-04 12:29:27,807 - controller.services.websocket_client - INFO - Received ADD_PLANT command from server
2025-09-04 12:29:27,808 - controller.services.websocket_client - INFO - Full message: {'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}
2025-09-04 12:29:27,808 - controller.services.websocket_client - INFO - Parsed data: {'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}
2025-09-04 12:29:27,808 - controller.services.websocket_client - INFO - Plant ID: 219
2025-09-04 12:29:27,808 - controller.services.websocket_client - INFO - Desired Moisture: 60
2025-09-04 12:29:27,808 - controller.services.websocket_client - INFO - Water Limit: 1
2025-09-04 12:29:27,808 - controller.handlers.add_plant_handler - INFO - Received add plant message from server: {'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}
2025-09-04 12:29:27,808 - controller.handlers.add_plant_handler - INFO - Message type: <class 'dict'>
2025-09-04 12:29:27,808 - controller.handlers.add_plant_handler - INFO - Available keys: ['plant_id', 'desiredMoisture', 'waterLimit', 'dripperType', 'lat', 'lon', 'scheduleData']
2025-09-04 12:29:27,810 - controller.handlers.add_plant_handler - INFO - Using plant_id 219 directly from server
2025-09-04 12:29:27,815 - controller.services.websocket_client - INFO - === ADD_PLANT RESPONSE DEBUG ===
2025-09-04 12:29:27,815 - controller.services.websocket_client - INFO - Response success: True
2025-09-04 12:29:27,815 - controller.services.websocket_client - INFO - Response DTO: plant_id=219 status='success' desired_moisture=60.0 assigned_valve=1 sensor_port='/dev/ttyUSB0' error_message=None timestamp=1756978167.8140821
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 219, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 1, 'sensor_port': '/dev/ttyUSB0', 'error_message': None, 'timestamp': 1756978167.8140821}
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - ================================
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Message type: ADD_PLANT_RESPONSE
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Full message: {'type': 'ADD_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 1, 'sensor_port': '/dev/ttyUSB0', 'error_message': None, 'timestamp': 1756978167.8140821}}
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'desired_moisture', 'assigned_valve', 'sensor_port', 'error_message', 'timestamp']
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'status': 'success', 'desired_moisture': 60.0, 'assigned_valve': 1, 'sensor_port': '/dev/ttyUSB0', 'error_message': None, 'timestamp': 1756978167.8140821}
2025-09-04 12:29:27,816 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:27,817 - controller.services.websocket_client - INFO - Sent ADD_PLANT_RESPONSE message
2025-09-04 12:29:27,817 - controller.services.websocket_client - INFO - Successfully processed ADD_PLANT command
2025-09-04 12:29:27,911 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:29:27,911 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: ADD_PLANT_RESPONSE"}
2025-09-04 12:29:27,912 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: ADD_PLANT_RESPONSE'}
2025-09-04 12:29:27,912 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:29:27,912 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:27,912 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:29:27,912 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:29:27,913 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:29:27,913 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:29:27,913 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:29:33,300 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:29:33,301 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:29:33,301 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:29:33,302 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:29:33,302 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:33,302 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:29:33,302 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:29:33,305 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:29:33,305 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:29:33,306 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:33,306 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:29:33,306 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978173.3035638}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978173.3055634}}
2025-09-04 12:29:33,306 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:33,306 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:29:33,308 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978173.3035638}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978173.3055634}
2025-09-04 12:29:33,308 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:33,308 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:29:33,308 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:29:39,089 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:29:39,090 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 12:29:39,090 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 12:29:39,090 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:29:39,090 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 12:29:39,091 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:29:39,091 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 12:29:39,091 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 12:29:39,091 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=None
2025-09-04 12:29:39,091 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978179.091706}}
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978179.091706}
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:29:39,092 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 12:29:41,821 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:29:41,821 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:29:41,821 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:29:41,821 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:29:41,822 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:41,822 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:29:41,822 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:29:41,822 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:29:41,823 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:29:41,823 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:41,823 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:29:41,823 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978181.8225615}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978181.823577}}
2025-09-04 12:29:41,824 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:41,824 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:29:41,824 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978181.8225615}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978181.823577}
2025-09-04 12:29:41,824 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:41,825 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:29:41,825 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:29:46,345 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:29:46,345 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 12:29:46,345 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 12:29:46,346 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:29:46,346 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 12:29:46,346 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:29:46,346 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 12:29:46,346 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 12:29:46,347 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=None
2025-09-04 12:29:46,347 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:46,347 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:29:46,347 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978186.3476586}}
2025-09-04 12:29:46,347 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:46,347 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:29:46,349 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978186.3476586}
2025-09-04 12:29:46,349 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:46,349 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:29:46,349 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 12:29:48,431 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT message
2025-09-04 12:29:48,431 - controller.services.websocket_client - INFO - Full message: {"type":"IRRIGATE_PLANT","data":{"plant_id":219,"session_id":"ae992a33-99f8-457f-adaf-a298d958411f"}}
2025-09-04 12:29:48,432 - controller.services.websocket_client - INFO - Parsed data: {'type': 'IRRIGATE_PLANT', 'data': {'plant_id': 219, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}}
2025-09-04 12:29:48,432 - controller.services.websocket_client - INFO - Message type: 'IRRIGATE_PLANT' (length: 14)
2025-09-04 12:29:48,432 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}
2025-09-04 12:29:48,433 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT request for plant 219
2025-09-04 12:29:48,433 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:48,433 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_ACCEPTED
2025-09-04 12:29:48,433 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_ACCEPTED', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}}
2025-09-04 12:29:48,433 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:48,434 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'session_id']
2025-09-04 12:29:48,434 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}
2025-09-04 12:29:48,434 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:48,434 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_ACCEPTED message
2025-09-04 12:29:48,434 - controller.services.websocket_client - INFO - Started background irrigation task for plant 219
2025-09-04 12:29:48,436 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:48,436 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:29:48,436 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 42.0%)', 'details': None, 'timestamp': 1756978188.4364467, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}}
2025-09-04 12:29:48,436 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:48,437 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:29:48,437 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 42.0%)', 'details': None, 'timestamp': 1756978188.4364467, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}
2025-09-04 12:29:48,437 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:48,437 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:29:48,515 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:29:48,515 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: IRRIGATE_PLANT_ACCEPTED"}
2025-09-04 12:29:48,516 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: IRRIGATE_PLANT_ACCEPTED'}
2025-09-04 12:29:48,516 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:29:48,516 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:48,516 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:29:48,516 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:29:48,516 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:29:48,516 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:29:48,516 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:29:49,317 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:49,318 - controller.services.websocket_client - INFO - Message type: IRRIGATION_DECISION
2025-09-04 12:29:49,318 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_DECISION', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}}
2025-09-04 12:29:49,319 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:49,319 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'current_moisture', 'target_moisture', 'moisture_gap', 'will_irrigate', 'reason', 'session_id']
2025-09-04 12:29:49,321 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}
2025-09-04 12:29:49,321 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:49,322 - controller.services.websocket_client - INFO - Sent IRRIGATION_DECISION message
2025-09-04 12:29:49,328 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:49,329 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:29:49,329 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978189.3279595, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}}
2025-09-04 12:29:49,330 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:49,332 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:29:49,332 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978189.3279595, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}
2025-09-04 12:29:49,333 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:49,334 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:29:53,412 - controller.services.websocket_client - INFO - Received STOP_IRRIGATION message
2025-09-04 12:29:53,412 - controller.services.websocket_client - INFO - Full message: {"type":"STOP_IRRIGATION","data":{"plant_id":219,"plant_name":"219"}}
2025-09-04 12:29:53,413 - controller.services.websocket_client - INFO - Parsed data: {'type': 'STOP_IRRIGATION', 'data': {'plant_id': 219, 'plant_name': '219'}}
2025-09-04 12:29:53,413 - controller.services.websocket_client - INFO - Message type: 'STOP_IRRIGATION' (length: 15)
2025-09-04 12:29:53,413 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'plant_name': '219'}
2025-09-04 12:29:55,446 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:55,446 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_RESPONSE
2025-09-04 12:29:55,446 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756978195.4435623, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}}
2025-09-04 12:29:55,446 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:55,447 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'reason', 'moisture', 'final_moisture', 'water_added_liters', 'error_message', 'timestamp', 'session_id']
2025-09-04 12:29:55,447 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756978195.4435623, 'session_id': 'ae992a33-99f8-457f-adaf-a298d958411f'}
2025-09-04 12:29:55,447 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:55,448 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_RESPONSE message
2025-09-04 12:29:55,448 - controller.services.websocket_client - INFO - Sent irrigation result for plant 219: success
2025-09-04 12:29:55,449 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - Message type: STOP_IRRIGATION_RESPONSE
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - Full message: {'type': 'STOP_IRRIGATION_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756978195.4499192}}}
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - Message data values: {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756978195.4499192}}
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:55,451 - controller.services.websocket_client - INFO - Sent STOP_IRRIGATION_RESPONSE message
2025-09-04 12:29:55,452 - controller.services.websocket_client - INFO - STOP IRRIGATION SUCCESS: plant=219 final_moisture=30.0 water_added=0.0
2025-09-04 12:29:55,633 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:29:55,634 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:29:55,634 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:29:55,634 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:29:55,634 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:29:55,635 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:29:55,635 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:29:55,635 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:29:55,635 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:29:55,636 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:29:55,636 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:29:55,636 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978195.6354957}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978195.6367638}}
2025-09-04 12:29:55,637 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:29:55,637 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:29:55,637 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978195.6354957}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978195.6367638}
2025-09-04 12:29:55,637 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:29:55,637 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:29:55,639 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:30:32,061 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:30:32,063 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 12:30:32,063 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 12:30:32,064 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:30:32,064 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 12:30:32,064 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:30:32,065 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 12:30:32,065 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 12:30:32,067 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=None
2025-09-04 12:30:32,067 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:30:32,068 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:30:32,068 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978232.0670574}}
2025-09-04 12:30:32,068 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:30:32,069 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:30:32,069 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978232.0670574}
2025-09-04 12:30:32,071 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:30:32,071 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:30:32,072 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 12:30:34,771 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:30:34,772 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:30:34,773 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:30:39,775 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:30:39,776 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:30:39,776 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:30:39,778 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:30:39,789 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:30:39,790 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:30:39,790 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:30:39,790 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:30:39,791 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:30:39,791 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:30:39,792 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:30:39,792 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:30:39,792 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:30:40,789 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:30:40,789 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:30:40,789 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:30:40,790 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:30:40,790 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:30:40,790 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:30:40,790 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:30:40,790 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:30:40,790 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:30:40,791 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:30:40,791 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:30:40,791 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:30:40,791 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:30:40,791 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:30:41,796 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:30:41,796 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:30:41,796 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:30:41,796 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:30:41,796 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:30:41,798 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:30:41,798 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:30:41,798 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:30:41,798 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:30:41,799 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:30:41,799 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:30:41,799 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:30:41,800 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:30:41,800 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:30:41,800 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:30:41,800 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:30:41,801 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:30:41,801 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:30:41,801 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:30:41,801 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:30:41,802 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":60,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:30:41,802 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:30:41,802 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:30:41,804 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:30:41,804 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:30:41,804 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 60, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:30:41,805 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:30:41,805 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:30:41,805 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:30:41,805 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 12:30:41,805 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:30:41,806 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:30:41,806 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:30:41,806 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:30:41,809 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:30:41,809 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:30:41,809 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:30:41,809 - controller.services.websocket_client - INFO -   - Plant 219: 60.0% target moisture
2025-09-04 12:30:41,811 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:30:41,811 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:30:41,811 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:30:41,811 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:30:41,812 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:30:41,812 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:30:41,812 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:30:41,812 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:30:41,813 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:30:41,813 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:30:44,000 - controller.services.websocket_client - INFO - Received OPEN_VALVE message
2025-09-04 12:30:44,001 - controller.services.websocket_client - INFO - Full message: {"type":"OPEN_VALVE","data":{"plant_id":219,"time_minutes":5}}
2025-09-04 12:30:44,002 - controller.services.websocket_client - INFO - Parsed data: {'type': 'OPEN_VALVE', 'data': {'plant_id': 219, 'time_minutes': 5}}
2025-09-04 12:30:44,002 - controller.services.websocket_client - INFO - Message type: 'OPEN_VALVE' (length: 10)
2025-09-04 12:30:44,003 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'time_minutes': 5}
2025-09-04 12:30:44,003 - controller.services.websocket_client - INFO - Received OPEN_VALVE request for plant 219, duration: 5 minutes
2025-09-04 12:30:44,012 - controller.services.websocket_client - INFO - === OPEN_VALVE RESPONSE DEBUG ===
2025-09-04 12:30:44,013 - controller.services.websocket_client - INFO - Result status: success
2025-09-04 12:30:44,015 - controller.services.websocket_client - INFO - Result reason: Valve opened for plant 219 for 5 minutes
2025-09-04 12:30:44,015 - controller.services.websocket_client - INFO - Result error_message: None
2025-09-04 12:30:44,015 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 12:30:44,016 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 219, 'time_minutes': 5, 'status': 'success', 'timestamp': 1756978244.0126927, 'message': 'Valve opened for plant 219 for 5 minutes', 'reason': 'Valve opened for plant 219 for 5 minutes'}
2025-09-04 12:30:44,017 - controller.services.websocket_client - INFO - ====================================
2025-09-04 12:30:44,017 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:30:44,017 - controller.services.websocket_client - INFO - Message type: OPEN_VALVE_RESPONSE
2025-09-04 12:30:44,019 - controller.services.websocket_client - INFO - Full message: {'type': 'OPEN_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'time_minutes': 5, 'status': 'success', 'timestamp': 1756978244.0126927, 'message': 'Valve opened for plant 219 for 5 minutes', 'reason': 'Valve opened for plant 219 for 5 minutes'}}
2025-09-04 12:30:44,019 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:30:44,020 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 12:30:44,021 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'time_minutes': 5, 'status': 'success', 'timestamp': 1756978244.0126927, 'message': 'Valve opened for plant 219 for 5 minutes', 'reason': 'Valve opened for plant 219 for 5 minutes'}
2025-09-04 12:30:44,021 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:30:44,022 - controller.services.websocket_client - INFO - Sent OPEN_VALVE_RESPONSE message
2025-09-04 12:30:44,023 - controller.services.websocket_client - INFO - Open valve request completed for plant 219: success
2025-09-04 12:30:46,693 - controller.services.websocket_client - INFO - Received CLOSE_VALVE message
2025-09-04 12:30:46,694 - controller.services.websocket_client - INFO - Full message: {"type":"CLOSE_VALVE","data":{"plant_id":219}}
2025-09-04 12:30:46,694 - controller.services.websocket_client - INFO - Parsed data: {'type': 'CLOSE_VALVE', 'data': {'plant_id': 219}}
2025-09-04 12:30:46,695 - controller.services.websocket_client - INFO - Message type: 'CLOSE_VALVE' (length: 11)
2025-09-04 12:30:46,695 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 12:30:46,696 - controller.services.websocket_client - INFO - Received CLOSE_VALVE request for plant 219
2025-09-04 12:30:46,698 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:30:46,698 - controller.services.websocket_client - INFO - Message type: CLOSE_VALVE_RESPONSE
2025-09-04 12:30:46,699 - controller.services.websocket_client - INFO - Full message: {'type': 'CLOSE_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}}
2025-09-04 12:30:46,699 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:30:46,699 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 12:30:46,701 - controller.services.websocket_client - INFO - Message data values: {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}
2025-09-04 12:30:46,701 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:30:46,702 - controller.services.websocket_client - INFO - Sent CLOSE_VALVE_RESPONSE message
2025-09-04 12:30:46,703 - controller.services.websocket_client - INFO - Successfully closed valve for plant 219
2025-09-04 12:30:48,482 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:30:48,482 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:30:48,482 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:30:48,482 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:30:48,483 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:30:48,483 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:30:48,483 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:30:48,483 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:30:48,483 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:30:48,483 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:30:48,483 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:30:48,485 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978248.483859}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978248.483859}}
2025-09-04 12:30:48,485 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:30:48,485 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:30:48,485 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978248.483859}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978248.483859}
2025-09-04 12:30:48,485 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:30:48,485 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:30:48,486 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:31:44,531 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:31:44,531 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 12:31:44,531 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 12:31:44,532 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:31:44,532 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 12:31:44,532 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:31:44,533 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 12:31:44,533 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 12:31:44,533 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=None
2025-09-04 12:31:44,534 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:31:44,534 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:31:44,534 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978304.5333953}}
2025-09-04 12:31:44,534 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:31:44,535 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:31:44,535 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978304.5333953}
2025-09-04 12:31:44,535 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:31:44,536 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:31:44,536 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 12:31:54,246 - controller.services.websocket_client - INFO - Received UPDATE_PLANT message
2025-09-04 12:31:54,246 - controller.services.websocket_client - INFO - Full message: {"type":"UPDATE_PLANT","data":{"plant_id":219,"plant_name":"Plant1","desired_moisture":55,"water_limit":1,"dripper_type":"2L/h"}}
2025-09-04 12:31:54,247 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UPDATE_PLANT', 'data': {'plant_id': 219, 'plant_name': 'Plant1', 'desired_moisture': 55, 'water_limit': 1, 'dripper_type': '2L/h'}}
2025-09-04 12:31:54,247 - controller.services.websocket_client - INFO - Message type: 'UPDATE_PLANT' (length: 12)
2025-09-04 12:31:54,247 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'plant_name': 'Plant1', 'desired_moisture': 55, 'water_limit': 1, 'dripper_type': '2L/h'}
2025-09-04 12:31:54,267 - controller.services.websocket_client - INFO - Received UPDATE_PLANT command from server
2025-09-04 12:31:54,267 - controller.services.websocket_client - INFO - Full message: {'type': 'UPDATE_PLANT', 'data': {'plant_id': 219, 'plant_name': 'Plant1', 'desired_moisture': 55, 'water_limit': 1, 'dripper_type': '2L/h'}}
2025-09-04 12:31:54,268 - controller.handlers.update_plant_handler - INFO - Updating plant 219 with new settings
2025-09-04 12:31:54,269 - controller.handlers.update_plant_handler - INFO - Successfully updated plant 219
2025-09-04 12:31:54,269 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:31:54,269 - controller.services.websocket_client - INFO - Message type: UPDATE_PLANT_RESPONSE
2025-09-04 12:31:54,271 - controller.services.websocket_client - INFO - Full message: {'type': 'UPDATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'success': True, 'message': 'Plant 219 updated successfully'}}
2025-09-04 12:31:54,271 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:31:54,272 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'success', 'message']
2025-09-04 12:31:54,272 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'success': True, 'message': 'Plant 219 updated successfully'}
2025-09-04 12:31:54,272 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:31:54,272 - controller.services.websocket_client - INFO - Sent UPDATE_PLANT_RESPONSE message
2025-09-04 12:31:54,273 - controller.services.websocket_client - INFO - Successfully updated plant 219
2025-09-04 12:31:54,305 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:31:54,305 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: UPDATE_PLANT_RESPONSE"}
2025-09-04 12:31:54,306 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: UPDATE_PLANT_RESPONSE'}
2025-09-04 12:31:54,306 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:31:54,306 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:31:54,306 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:31:54,307 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:31:54,307 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:31:54,307 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:31:54,307 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:31:57,791 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT message
2025-09-04 12:31:57,791 - controller.services.websocket_client - INFO - Full message: {"type":"IRRIGATE_PLANT","data":{"plant_id":219,"session_id":"46a39131-f242-4322-9895-edaa601b05e6"}}
2025-09-04 12:31:57,793 - controller.services.websocket_client - INFO - Parsed data: {'type': 'IRRIGATE_PLANT', 'data': {'plant_id': 219, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:31:57,793 - controller.services.websocket_client - INFO - Message type: 'IRRIGATE_PLANT' (length: 14)
2025-09-04 12:31:57,793 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:31:57,794 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT request for plant 219
2025-09-04 12:31:57,794 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:31:57,795 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_ACCEPTED
2025-09-04 12:31:57,795 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_ACCEPTED', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:31:57,795 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:31:57,795 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'session_id']
2025-09-04 12:31:57,795 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:31:57,796 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:31:57,796 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_ACCEPTED message
2025-09-04 12:31:57,797 - controller.services.websocket_client - INFO - Started background irrigation task for plant 219
2025-09-04 12:31:57,800 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:31:57,800 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:31:57,800 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 46.0%)', 'details': None, 'timestamp': 1756978317.7989461, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:31:57,800 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:31:57,801 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:31:57,802 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 46.0%)', 'details': None, 'timestamp': 1756978317.7989461, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:31:57,802 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:31:57,802 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:31:57,807 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:31:57,810 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: IRRIGATE_PLANT_ACCEPTED"}
2025-09-04 12:31:57,811 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: IRRIGATE_PLANT_ACCEPTED'}
2025-09-04 12:31:57,813 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:31:57,813 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:31:57,814 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:31:57,814 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:31:57,815 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:31:57,815 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:31:57,815 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:31:58,641 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:31:58,641 - controller.services.websocket_client - INFO - Message type: IRRIGATION_DECISION
2025-09-04 12:31:58,641 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_DECISION', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:31:58,641 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:31:58,642 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'current_moisture', 'target_moisture', 'moisture_gap', 'will_irrigate', 'reason', 'session_id']
2025-09-04 12:31:58,642 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:31:58,642 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:31:58,642 - controller.services.websocket_client - INFO - Sent IRRIGATION_DECISION message
2025-09-04 12:31:58,643 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:31:58,643 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:31:58,643 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978318.643735, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:31:58,644 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:31:58,644 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:31:58,644 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978318.643735, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:31:58,644 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:31:58,644 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:32:04,798 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:32:04,799 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:32:04,799 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:32:08,645 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:08,646 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:32:08,647 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978328.6447437, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:32:08,648 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:08,648 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:32:08,649 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978328.6447437, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:32:08,650 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:08,651 - controller.services.websocket_client - ERROR - Failed to send message: received 4000 (private use) Stale; then sent 4000 (private use) Stale
2025-09-04 12:32:09,819 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:32:09,820 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:32:09,820 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:32:09,822 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:32:09,827 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:32:09,828 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:09,828 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:32:09,829 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:32:09,829 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:32:09,831 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:32:09,832 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:32:09,832 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:09,833 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:32:10,836 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:32:10,836 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:32:10,836 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:32:10,838 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:10,840 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:32:10,840 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:32:10,840 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:32:11,843 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:32:11,843 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:32:11,843 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:32:11,843 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:32:11,843 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:32:11,845 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:32:11,846 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:32:11,846 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:32:11,846 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:32:11,846 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:32:11,846 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:32:11,847 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:32:11,847 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:32:11,847 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:32:11,847 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:32:11,847 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:32:11,848 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:32:11,849 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:32:11,849 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:32:11,849 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:32:11,849 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:32:11,849 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:32:11,849 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:32:11,850 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:32:11,850 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:32:11,851 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:32:11,851 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:32:11,851 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:32:11,851 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:32:18,650 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:18,650 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:32:18,650 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978338.6507075, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:32:18,652 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:18,652 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:32:18,652 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978338.6507075, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:32:18,652 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:18,653 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:32:28,662 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:28,663 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:32:28,663 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978348.6614172, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:32:28,664 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:28,664 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:32:28,665 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978348.6614172, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:32:28,665 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:28,667 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:32:38,663 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:38,663 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:32:38,664 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978358.6630354, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:32:38,664 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:38,664 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:32:38,664 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978358.6630354, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:32:38,665 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:38,665 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:32:48,664 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:48,665 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:32:48,665 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978368.6641023, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:32:48,665 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:48,666 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:32:48,666 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978368.6641023, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:32:48,666 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:48,668 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:32:58,682 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:32:58,682 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:32:58,682 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978378.6816792, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:32:58,682 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:32:58,683 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:32:58,683 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978378.6816792, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:32:58,683 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:32:58,684 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:33:08,694 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:08,694 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:33:08,694 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978388.6946287, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:33:08,696 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:08,696 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:33:08,696 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978388.6946287, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:33:08,696 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:08,697 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:33:18,694 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:18,694 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:33:18,696 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978398.694877, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:33:18,696 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:18,696 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:33:18,696 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978398.694877, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:33:18,697 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:18,697 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:33:28,709 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:28,709 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:33:28,709 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978408.7091658, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:33:28,709 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:28,709 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:33:28,710 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978408.7091658, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:33:28,710 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:28,710 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:33:34,798 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:33:34,798 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:33:34,798 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:33:34,799 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:33:34,799 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:34,799 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:33:34,799 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:33:34,799 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:33:34,800 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:33:34,800 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:34,800 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:33:34,800 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978414.7998009}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978414.8007994}}
2025-09-04 12:33:34,800 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:34,800 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:33:34,801 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978414.7998009}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978414.8007994}
2025-09-04 12:33:34,801 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:34,801 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:33:34,801 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:33:34,825 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:33:34,825 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:33:34,825 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:33:38,716 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:38,718 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:33:38,718 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978418.7168276, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:33:38,718 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:38,718 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:33:38,719 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978418.7168276, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:33:38,719 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:38,719 - controller.services.websocket_client - ERROR - Failed to send message: received 4000 (private use) Stale; then sent 4000 (private use) Stale
2025-09-04 12:33:39,837 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:33:39,837 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:33:39,838 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:33:39,838 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:33:39,843 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:33:39,843 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:39,843 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:33:39,844 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:33:39,844 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:33:39,844 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:33:39,845 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:33:39,845 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:39,846 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:33:40,848 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:33:40,849 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:33:40,849 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:33:40,850 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:33:40,850 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:40,851 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:33:40,853 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:33:40,853 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:40,854 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:33:40,854 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:33:40,855 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:40,855 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:33:40,856 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:33:40,856 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:33:41,881 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:33:41,881 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:33:41,882 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:33:41,882 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:33:41,882 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:33:41,882 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:33:41,883 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:33:41,883 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:33:41,883 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:33:41,883 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:33:41,884 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:33:41,884 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:33:41,884 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:33:41,884 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:33:41,884 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:33:41,884 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:33:41,886 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:33:41,886 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:41,886 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:33:41,887 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:33:41,887 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:33:41,887 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:33:41,887 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:33:41,887 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:41,888 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:33:41,888 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:33:41,888 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:33:41,888 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:33:41,888 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:41,889 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:33:41,889 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978421.8888469}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978421.8888469}}
2025-09-04 12:33:41,889 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:41,889 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:33:41,889 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978421.8888469}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978421.8888469}
2025-09-04 12:33:41,889 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:41,891 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:33:41,891 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:33:41,891 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:33:41,891 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:33:41,891 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:33:41,891 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:33:41,892 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:41,892 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:33:41,892 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:33:41,892 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:33:41,892 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:33:41,893 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:33:41,893 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:33:41,893 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:33:41,893 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:33:41,893 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:33:41,893 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:33:41,895 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:33:41,895 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:33:41,895 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:33:41,895 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:33:41,895 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:33:41,896 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:33:41,896 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:33:41,896 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:33:41,896 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:41,896 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:33:41,896 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:33:41,896 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:33:41,896 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:33:41,898 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:33:42,875 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:33:42,876 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":214}}
2025-09-04 12:33:42,876 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 214}}
2025-09-04 12:33:42,876 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:33:42,876 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214}
2025-09-04 12:33:42,876 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:33:42,876 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 214
2025-09-04 12:33:42,876 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 214 directly from server
2025-09-04 12:33:42,878 - controller.handlers.get_plant_moisture_handler - WARNING - Failed to read sensor data for plant 214
2025-09-04 12:33:42,878 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:42,878 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:33:42,878 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': None, 'temperature': None, 'status': 'error', 'error_message': 'Failed to read sensor data', 'timestamp': 1756978422.878289}}
2025-09-04 12:33:42,878 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:42,878 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:33:42,879 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': None, 'temperature': None, 'status': 'error', 'error_message': 'Failed to read sensor data', 'timestamp': 1756978422.878289}
2025-09-04 12:33:42,879 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:42,879 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:33:42,879 - controller.services.websocket_client - ERROR - Failed to get moisture for plant 214: Failed to read sensor data
2025-09-04 12:33:45,443 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:33:45,443 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:33:45,444 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:33:45,444 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:33:45,444 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:45,444 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:33:45,444 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:33:45,445 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:33:45,445 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:33:45,445 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:45,445 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:33:45,445 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978425.4453368}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978425.4453368}}
2025-09-04 12:33:45,445 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:45,445 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:33:45,446 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978425.4453368}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978425.4453368}
2025-09-04 12:33:45,446 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:45,446 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:33:45,446 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:33:47,851 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:33:47,852 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":212}}
2025-09-04 12:33:47,852 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 212}}
2025-09-04 12:33:47,852 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:33:47,853 - controller.services.websocket_client - INFO - Message data: {'plant_id': 212}
2025-09-04 12:33:47,853 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:33:47,853 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 212
2025-09-04 12:33:47,854 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 212 directly from server
2025-09-04 12:33:47,854 - controller.handlers.get_plant_moisture_handler - WARNING - Failed to read sensor data for plant 212
2025-09-04 12:33:47,855 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:47,855 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:33:47,855 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 212, 'moisture': None, 'temperature': None, 'status': 'error', 'error_message': 'Failed to read sensor data', 'timestamp': 1756978427.8552918}}
2025-09-04 12:33:47,855 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:47,856 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:33:47,856 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 212, 'moisture': None, 'temperature': None, 'status': 'error', 'error_message': 'Failed to read sensor data', 'timestamp': 1756978427.8552918}
2025-09-04 12:33:47,856 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:47,857 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:33:47,857 - controller.services.websocket_client - ERROR - Failed to get moisture for plant 212: Failed to read sensor data
2025-09-04 12:33:48,729 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:48,730 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:33:48,730 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978428.7295957, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:33:48,731 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:48,731 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:33:48,731 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978428.7295957, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:33:48,731 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:48,732 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:33:49,657 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:33:49,658 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:33:49,658 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:33:49,658 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:33:49,658 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:33:49,658 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:33:49,658 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:33:49,659 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:33:49,659 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:33:49,659 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:49,659 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:33:49,659 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978429.6592536}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978429.6592536}}
2025-09-04 12:33:49,660 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:49,660 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:33:49,660 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978429.6592536}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978429.6592536}
2025-09-04 12:33:49,660 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:49,661 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:33:49,661 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:33:58,746 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:33:58,748 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:33:58,748 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978438.7468743, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:33:58,748 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:33:58,748 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:33:58,748 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978438.7468743, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:33:58,749 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:33:58,749 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:34:00,098 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:34:00,098 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:34:00,098 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:34:00,099 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:34:00,099 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:34:00,099 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:34:00,099 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:34:00,099 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:34:00,100 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:34:00,100 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:00,100 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:34:00,100 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978440.0992594}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978440.1002603}}
2025-09-04 12:34:00,100 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:00,101 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:34:00,101 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978440.0992594}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978440.1002603}
2025-09-04 12:34:00,101 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:00,102 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:34:00,102 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:34:08,760 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:08,761 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:34:08,761 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978448.760202, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:34:08,761 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:08,762 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:34:08,762 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978448.760202, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:34:08,762 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:08,762 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:34:17,920 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:34:17,921 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:34:17,921 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:34:17,921 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:34:17,921 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:34:17,922 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:34:17,922 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:34:17,922 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:34:17,922 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:34:17,922 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:17,922 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:34:17,922 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978457.9227502}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978457.9227502}}
2025-09-04 12:34:17,924 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:17,924 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:34:17,924 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978457.9227502}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978457.9227502}
2025-09-04 12:34:17,924 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:17,924 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:34:17,925 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:34:18,763 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:18,763 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:34:18,763 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978458.763111, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:34:18,764 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:18,764 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:34:18,764 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978458.763111, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:34:18,764 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:18,765 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:34:28,779 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:28,780 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:34:28,780 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978468.7791398, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:34:28,780 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:28,780 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:34:28,781 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978468.7791398, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:34:28,781 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:28,781 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:34:38,785 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:38,787 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:34:38,787 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978478.7857842, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:34:38,787 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:38,787 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:34:38,788 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978478.7857842, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:34:38,788 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:38,788 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:34:48,774 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:48,774 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:34:48,774 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978488.774011, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:34:48,775 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:48,775 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:34:48,775 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978488.774011, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:34:48,775 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:48,776 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:34:58,770 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:34:58,771 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:34:58,771 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978498.7696362, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:34:58,772 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:34:58,772 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:34:58,772 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978498.7696362, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:34:58,772 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:34:58,774 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:35:04,842 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:35:04,843 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:35:04,843 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:35:08,769 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:08,769 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:35:08,769 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978508.7693627, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:35:08,770 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:08,770 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:35:08,770 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978508.7693627, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:35:08,770 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:08,770 - controller.services.websocket_client - ERROR - Failed to send message: received 4000 (private use) Stale; then sent 4000 (private use) Stale
2025-09-04 12:35:09,858 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:35:09,858 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:35:09,859 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:35:09,859 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:35:09,866 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:35:09,866 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:09,868 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:35:09,868 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:35:09,868 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:35:09,868 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:35:09,868 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:35:09,868 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:09,869 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:35:10,882 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:35:10,882 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:35:10,882 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:35:10,882 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:35:10,882 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:10,883 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:35:10,883 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:35:10,883 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:10,883 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:35:10,883 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:35:10,883 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:10,885 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:35:10,885 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:35:10,885 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:35:11,888 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:35:11,888 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:35:11,888 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:35:11,889 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:35:11,889 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:35:11,889 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:35:11,889 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:35:11,889 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:35:11,889 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:35:11,890 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:35:11,890 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:35:11,890 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:35:11,890 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:35:11,890 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:35:11,891 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:35:11,891 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:35:11,891 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:35:11,891 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:35:11,891 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:35:11,892 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:35:11,892 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:35:11,892 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:35:11,893 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:35:11,893 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:35:11,893 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:35:11,893 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:35:11,894 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:35:11,896 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:35:11,897 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:35:11,897 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:35:11,897 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:35:11,897 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:35:11,897 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:35:11,898 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:35:11,898 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:35:11,898 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:35:11,898 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:35:11,898 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:35:11,898 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:35:11,898 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:35:11,898 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:35:18,787 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:18,787 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:35:18,787 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978518.7879333, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:35:18,787 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:18,787 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:35:18,789 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978518.7879333, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:35:18,789 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:18,789 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:35:29,056 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:29,130 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:35:29,192 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978528.9634197, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:35:29,193 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:29,194 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:35:29,195 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978528.9634197, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:35:29,196 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:29,197 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:35:39,211 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:39,214 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:35:39,219 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978539.2112184, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:35:39,226 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:39,233 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:35:39,238 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978539.2112184, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:35:39,243 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:39,256 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:35:49,277 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:49,277 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:35:49,278 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978549.2776887, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:35:49,278 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:49,278 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:35:49,278 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978549.2776887, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:35:49,278 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:49,279 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:35:59,302 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:35:59,302 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:35:59,302 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978559.3019361, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:35:59,302 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:35:59,303 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:35:59,307 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978559.3019361, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:35:59,307 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:35:59,308 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:36:09,319 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:09,320 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:36:09,321 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978569.3167198, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:36:09,322 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:09,322 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:36:09,322 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978569.3167198, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:36:09,322 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:09,324 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:36:19,315 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:19,315 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:36:19,316 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978579.3135662, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:36:19,317 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:19,317 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:36:19,317 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978579.3135662, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:36:19,318 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:19,319 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:36:27,157 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:36:27,157 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:36:27,158 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:36:27,158 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:36:27,158 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:36:27,160 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:36:27,161 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:36:27,161 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:36:27,161 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:36:27,163 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:27,163 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:36:27,163 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978587.1610115}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978587.1623075}}
2025-09-04 12:36:27,163 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:27,163 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:36:27,164 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978587.1610115}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978587.1623075}
2025-09-04 12:36:27,164 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:27,164 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:36:27,164 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:36:29,326 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:29,326 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:36:29,326 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978589.3269074, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:36:29,328 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:29,328 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:36:29,328 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978589.3269074, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:36:29,329 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:29,329 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 12:36:34,879 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:36:34,880 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:36:34,880 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:36:39,337 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:39,338 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 12:36:39,338 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978599.337021, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:36:39,340 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:39,341 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 12:36:39,341 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756978599.337021, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:36:39,342 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:39,344 - controller.services.websocket_client - ERROR - Failed to send message: received 4000 (private use) Stale; then sent 4000 (private use) Stale
2025-09-04 12:36:39,889 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:36:39,889 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:36:39,890 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:36:39,890 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:36:39,912 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:36:39,912 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:39,912 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:36:39,912 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:36:39,913 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:36:39,913 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:36:39,913 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:36:39,913 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:39,913 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:36:40,928 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:36:40,928 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:36:40,928 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:36:40,928 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:36:40,928 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:40,930 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:36:40,930 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:36:40,930 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:40,930 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:36:40,930 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:36:40,931 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:40,931 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:36:40,931 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:36:40,931 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:36:41,947 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:36:41,948 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:36:41,948 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:36:41,948 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:36:41,950 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:36:41,950 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:36:41,951 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:36:41,951 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:36:41,951 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:36:41,953 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:36:41,953 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:36:41,954 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:36:41,955 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:36:41,957 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:36:41,957 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:36:41,958 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:36:41,958 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:36:41,959 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:36:41,959 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:36:41,961 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:36:41,961 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:36:41,963 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:36:41,963 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:36:41,964 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:36:41,964 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:36:41,965 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:36:41,965 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:36:41,966 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:36:41,966 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:36:41,968 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:36:41,968 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:36:41,968 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:36:41,969 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:36:41,969 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:36:41,976 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:36:41,976 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:36:41,977 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:36:41,977 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:36:41,978 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:36:41,979 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:36:41,979 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:36:41,980 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:36:41,980 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:36:41,982 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:36:41,982 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:36:41,982 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:36:41,984 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:36:41,985 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:36:41,985 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 12:36:41,985 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 12:36:41,985 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 12:36:41,986 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 12:36:41,986 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 12:36:41,987 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 12:36:41,988 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 12:36:41,988 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 12:36:41,988 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=None
2025-09-04 12:36:41,988 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:41,988 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 12:36:41,990 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978601.9888837}}
2025-09-04 12:36:41,990 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:41,991 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 12:36:41,991 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978601.9888837}
2025-09-04 12:36:41,991 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:41,992 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 12:36:41,992 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 12:36:42,338 - controller.services.websocket_client - INFO - Received STOP_IRRIGATION message
2025-09-04 12:36:42,338 - controller.services.websocket_client - INFO - Full message: {"type":"STOP_IRRIGATION","data":{"plant_id":219,"plant_name":"219"}}
2025-09-04 12:36:42,338 - controller.services.websocket_client - INFO - Parsed data: {'type': 'STOP_IRRIGATION', 'data': {'plant_id': 219, 'plant_name': '219'}}
2025-09-04 12:36:42,338 - controller.services.websocket_client - INFO - Message type: 'STOP_IRRIGATION' (length: 15)
2025-09-04 12:36:42,338 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'plant_name': '219'}
2025-09-04 12:36:44,389 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:44,389 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_RESPONSE
2025-09-04 12:36:44,391 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.06666666666666667, 'error_message': None, 'timestamp': 1756978604.3839586, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}}
2025-09-04 12:36:44,392 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:44,393 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'reason', 'moisture', 'final_moisture', 'water_added_liters', 'error_message', 'timestamp', 'session_id']
2025-09-04 12:36:44,393 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.06666666666666667, 'error_message': None, 'timestamp': 1756978604.3839586, 'session_id': '46a39131-f242-4322-9895-edaa601b05e6'}
2025-09-04 12:36:44,393 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:44,394 - controller.services.websocket_client - ERROR - Failed to send message: received 4000 (private use) Stale; then sent 4000 (private use) Stale
2025-09-04 12:36:44,395 - controller.services.websocket_client - INFO - Sent irrigation result for plant 219: success
2025-09-04 12:36:44,402 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:44,403 - controller.services.websocket_client - INFO - Message type: STOP_IRRIGATION_RESPONSE
2025-09-04 12:36:44,403 - controller.services.websocket_client - INFO - Full message: {'type': 'STOP_IRRIGATION_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756978604.3997579}}}
2025-09-04 12:36:44,404 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:44,404 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 12:36:44,405 - controller.services.websocket_client - INFO - Message data values: {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756978604.3997579}}
2025-09-04 12:36:44,406 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:44,407 - controller.services.websocket_client - INFO - Sent STOP_IRRIGATION_RESPONSE message
2025-09-04 12:36:44,407 - controller.services.websocket_client - INFO - STOP IRRIGATION SUCCESS: plant=219 final_moisture=30.0 water_added=0.0
2025-09-04 12:36:45,945 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 12:36:45,945 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 12:36:45,945 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 12:36:45,945 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 12:36:45,946 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:36:45,947 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 12:36:45,947 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 12:36:45,947 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=None
2025-09-04 12:36:45,947 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 12:36:45,948 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:36:45,948 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 12:36:45,948 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978605.9470756}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978605.9485862}}
2025-09-04 12:36:45,949 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:36:45,949 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 12:36:45,949 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': None, 'status': 'success', 'error_message': None, 'timestamp': 1756978605.9470756}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756978605.9485862}
2025-09-04 12:36:45,949 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:36:45,950 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 12:36:45,950 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 12:38:04,886 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:38:04,887 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:38:04,887 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:38:09,894 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:38:09,894 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:38:09,895 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:38:09,895 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:38:09,905 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:38:09,906 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:38:09,907 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:38:09,907 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:38:09,908 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:38:09,908 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:38:09,908 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:38:09,910 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:38:09,911 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:38:10,931 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:38:10,931 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:38:10,932 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:38:10,932 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:38:10,932 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:38:10,932 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:38:10,932 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:38:10,934 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:38:10,934 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:38:10,934 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:38:10,935 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:38:10,935 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:38:10,936 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:38:10,936 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:38:11,946 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:38:11,946 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:38:11,946 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:38:11,946 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:38:11,947 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:38:11,948 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:38:11,950 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:38:11,950 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:38:11,951 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:38:11,951 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:38:11,951 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:38:11,951 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:38:11,951 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:38:11,951 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:38:11,952 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:38:11,952 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:38:11,952 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:38:11,952 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:38:11,952 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:38:11,952 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:38:11,953 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:38:11,953 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:38:11,953 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:38:11,953 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:38:11,953 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:38:11,955 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:39:34,926 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:39:34,928 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:39:34,928 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:39:39,932 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:39:39,932 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:39:39,933 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:39:39,933 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:39:40,007 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:39:40,007 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:39:40,008 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:39:41,014 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:39:41,016 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:39:41,016 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:39:41,016 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:39:41,016 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:39:41,016 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:39:41,016 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:39:42,021 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:39:42,022 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:39:42,022 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:39:42,023 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:39:42,024 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:39:42,025 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:39:42,025 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:39:42,052 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:39:42,052 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:39:42,052 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:39:42,052 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:39:42,052 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:39:42,052 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:39:42,054 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:39:42,054 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:39:42,054 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:39:42,054 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:39:42,054 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:39:42,054 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:39:42,056 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:39:42,056 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:39:42,057 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:39:42,057 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:39:42,057 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:39:42,058 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:39:42,058 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:39:42,058 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:41:04,941 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:41:04,941 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:41:04,942 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:41:09,943 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:41:09,943 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:41:09,943 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:41:09,943 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:41:09,948 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:41:09,948 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:41:09,948 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:41:09,948 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:41:09,949 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:41:09,949 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:41:09,949 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:41:09,949 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:41:09,949 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:41:10,964 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:41:10,965 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:41:10,965 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:41:10,965 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:41:10,966 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:41:10,966 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:41:10,967 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:41:10,968 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:41:10,969 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:41:10,969 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:41:10,970 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:41:10,971 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:41:10,971 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:41:10,972 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:41:11,981 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:41:11,982 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:41:11,982 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:41:11,983 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:41:11,984 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:41:11,984 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:41:11,984 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:41:11,986 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:41:11,986 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:41:11,986 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:41:11,987 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:41:11,987 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:41:11,988 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:41:11,988 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:41:11,989 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:41:11,989 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:41:11,990 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:41:11,990 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:41:11,992 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:41:11,992 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:41:11,993 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:41:11,993 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:41:11,995 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:41:11,995 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:41:11,996 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:41:11,996 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:41:11,996 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:41:11,997 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:41:11,998 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:41:11,998 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:41:11,999 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:41:11,999 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:41:11,999 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:41:12,001 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:41:12,002 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:41:12,002 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:41:12,003 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:41:12,003 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:41:12,004 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:41:12,005 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:41:12,006 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:41:12,006 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:41:12,007 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:41:12,007 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:41:12,007 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:41:12,008 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:41:12,008 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:41:12,010 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:42:34,972 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:42:34,974 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:42:34,974 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:42:39,988 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:42:39,988 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:42:39,988 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:42:39,988 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:42:39,992 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:42:39,993 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:42:39,993 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:42:39,993 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:42:39,993 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:42:39,993 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:42:39,994 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:42:39,994 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:42:39,994 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:42:40,998 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:42:40,999 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:42:40,999 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:42:41,000 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:42:41,000 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:42:41,001 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:42:41,001 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:42:41,002 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:42:41,002 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:42:41,003 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:42:41,003 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:42:41,004 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:42:41,005 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:42:41,005 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:42:42,003 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:42:42,003 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:42:42,003 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:42:42,003 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:42:42,003 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:42:42,004 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:42:42,004 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:42:42,004 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:42:42,004 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:42:42,005 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:42:42,006 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:42:42,007 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:42:42,007 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:42:42,007 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:42:42,008 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:42:42,010 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:42:42,011 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:42:42,012 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:42:42,012 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:42:42,012 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:42:42,012 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:42:42,012 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:42:42,012 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:44:04,978 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:44:04,978 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:44:04,978 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:44:09,992 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:44:09,993 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:44:09,994 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:44:09,995 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:44:10,001 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:44:10,002 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:44:10,002 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:44:10,003 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:44:10,003 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:44:10,004 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:44:10,004 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:44:10,005 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:44:10,006 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:44:11,012 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:44:11,012 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:44:11,012 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:44:11,012 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:44:11,013 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:44:11,013 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:44:11,013 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:44:11,013 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:44:11,013 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:44:11,013 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:44:11,014 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:44:11,014 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:44:11,014 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:44:11,014 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:44:12,028 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:44:12,028 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:44:12,028 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:44:12,028 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:44:12,028 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:44:12,028 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:44:12,029 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:44:12,029 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:44:12,029 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:44:12,030 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:44:12,032 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:44:12,033 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:44:12,033 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:44:12,033 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:44:12,033 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:44:12,033 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:44:12,034 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:44:12,034 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:44:12,034 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:44:12,034 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:44:12,034 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:44:12,035 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:44:12,035 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:44:12,035 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:44:12,035 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:44:12,035 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:44:12,036 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:44:12,036 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:44:12,036 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:44:12,036 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:44:12,036 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:44:12,036 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:44:12,037 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:44:12,037 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:44:12,037 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:45:35,003 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:45:35,003 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:45:35,004 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:45:40,008 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:45:40,009 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:45:40,009 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:45:40,009 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:45:40,012 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:45:40,012 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:45:40,013 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:45:40,013 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:45:40,013 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:45:40,013 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:45:40,013 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:45:40,014 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:45:40,014 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:45:41,027 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:45:41,027 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:45:41,028 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:45:41,028 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:45:41,028 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:45:41,030 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:45:41,030 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:45:41,030 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:45:41,031 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:45:41,031 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:45:41,033 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:45:41,034 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:45:41,034 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:45:41,035 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:45:42,047 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:45:42,047 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:45:42,047 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:45:42,047 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:45:42,048 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:45:42,048 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:45:42,049 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:45:42,049 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:45:42,049 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:45:42,050 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:45:42,050 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:45:42,050 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:45:42,052 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:45:42,052 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:45:42,052 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:45:42,052 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:45:42,052 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:45:42,053 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:45:42,053 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:45:42,053 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:45:42,053 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:45:42,054 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:45:42,054 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:45:42,054 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:45:42,055 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:45:42,055 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:45:42,055 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:45:42,057 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:45:42,057 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:45:42,057 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:45:42,057 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:45:42,058 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:45:42,058 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:45:42,058 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:45:42,059 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:45:42,059 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:45:42,059 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:45:42,060 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:45:42,060 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:45:42,060 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:45:42,060 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:45:42,062 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:45:42,062 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:45:42,062 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:45:42,063 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:45:42,063 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:45:42,064 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:45:42,064 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:47:05,016 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:47:05,018 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:47:05,018 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:47:10,029 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:47:10,029 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:47:10,030 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:47:10,030 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:47:10,042 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:47:10,043 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:47:10,043 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:47:10,043 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:47:10,043 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:47:10,043 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:47:10,044 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:47:10,044 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:47:10,045 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:47:11,054 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:47:11,055 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:47:11,055 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:47:11,055 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:47:11,056 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:47:11,056 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:47:11,058 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:47:11,058 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:47:11,058 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:47:11,059 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:47:11,059 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:47:11,060 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:47:11,061 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:47:11,062 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:47:12,073 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:47:12,073 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:47:12,074 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:47:12,076 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:47:12,076 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:47:12,076 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:47:12,076 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:47:12,076 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:47:12,076 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:47:12,077 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:47:12,077 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:47:12,077 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:47:12,077 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:47:12,078 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:47:12,078 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:47:12,079 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:47:12,079 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:47:12,079 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:47:12,080 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:47:12,080 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:47:12,080 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:47:12,080 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:47:12,081 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:47:12,081 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:47:12,081 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:47:12,081 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:47:12,081 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:47:12,082 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:47:12,082 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:47:12,082 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:47:12,082 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:47:12,082 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:47:12,084 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:47:12,084 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:47:12,084 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:47:12,084 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:47:12,084 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:47:12,084 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:47:12,085 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:47:12,085 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:47:12,085 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:48:35,044 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:48:35,044 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:48:35,044 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:48:40,058 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:48:40,058 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:48:40,059 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:48:40,059 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:48:40,062 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:48:40,063 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:48:40,063 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:48:40,063 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:48:40,063 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:48:40,063 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:48:40,064 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:48:40,064 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:48:40,065 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:48:41,079 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:48:41,080 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:48:41,080 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:48:41,081 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:48:41,082 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:48:41,082 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:48:41,083 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:48:41,083 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:48:41,084 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:48:41,084 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:48:41,084 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:48:41,085 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:48:41,085 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:48:41,086 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:48:42,102 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:48:42,102 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:48:42,104 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:48:42,104 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:48:42,105 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:48:42,106 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:48:42,106 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:48:42,107 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:48:42,108 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:48:42,108 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:48:42,109 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:48:42,109 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:48:42,110 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:48:42,111 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:48:42,111 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:48:42,111 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:48:42,112 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:48:42,113 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:48:42,113 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:48:42,113 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:48:42,114 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:48:42,114 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:48:42,115 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:48:42,115 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:48:42,117 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:48:42,117 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:48:42,118 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:48:42,118 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:48:42,119 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:48:42,119 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:48:42,120 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:48:42,120 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:48:42,121 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:48:42,122 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:48:42,123 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:48:42,123 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:48:42,124 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:48:42,124 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:48:42,125 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:48:42,125 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:48:42,126 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:48:42,126 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:48:42,126 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:48:42,127 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:48:42,127 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:48:42,128 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:48:42,128 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:48:42,129 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:50:05,054 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 12:50:05,055 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:50:05,055 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 12:50:10,058 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 12:50:10,058 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 12:50:10,059 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 12:50:10,059 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 12:50:10,064 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 12:50:10,064 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:50:10,064 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 12:50:10,064 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 12:50:10,064 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 12:50:10,065 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 12:50:10,066 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 12:50:10,066 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:50:10,066 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 12:50:11,083 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 12:50:11,083 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 12:50:11,083 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 12:50:11,083 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 12:50:11,084 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 12:50:11,084 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 12:50:11,084 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 12:50:11,084 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 12:50:11,085 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 12:50:11,085 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 12:50:11,085 - controller.services.websocket_client - INFO - =============================
2025-09-04 12:50:11,085 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 12:50:11,085 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 12:50:11,085 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 12:50:12,083 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 12:50:12,083 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 12:50:12,083 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 12:50:12,083 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 12:50:12,083 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 12:50:12,084 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 12:50:12,084 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 12:50:12,084 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 12:50:12,084 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 12:50:12,085 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 12:50:12,085 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 12:50:12,085 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 12:50:12,085 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 12:50:12,085 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 12:50:12,085 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 12:50:12,086 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:50:12,088 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 12:50:12,088 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:50:12,088 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 12:50:12,088 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 12:50:12,089 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 12:50:12,090 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 12:50:12,090 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 12:50:12,090 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 12:50:12,091 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 12:50:12,091 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 12:50:12,091 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 12:50:12,091 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 12:50:12,091 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 12:50:12,091 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 12:50:12,092 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 12:50:12,092 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 12:50:12,092 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 12:50:12,092 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 12:50:12,092 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 12:50:12,092 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 12:50:36,481 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 12:50:36,493 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:50:36,498 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:50:36,499 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 12:50:36,499 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:50:36,499 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 12:50:36,499 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 12:50:36,500 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 13:00:30,299 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-04 13:00:30,299 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.67:8080
2025-09-04 13:00:30,299 - controller.run_pi_client - INFO - Family Code: IRIS12
2025-09-04 13:00:30,299 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-04 13:00:30,300 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-04 13:00:30,300 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-04 13:00:30,300 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-04 13:00:30,301 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-04 13:00:30,301 - controller.run_pi_client - INFO - Family code configured: IRIS12
2025-09-04 13:00:30,302 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:00:30,302 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:00:30,302 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:00:30,302 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:00:30,343 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:00:30,343 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:30,343 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:00:30,345 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:00:30,345 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:00:30,345 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:00:30,345 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:00:30,345 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:30,346 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:00:31,348 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:00:31,348 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:00:31,349 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:00:31,349 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:00:31,349 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:31,349 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:00:31,350 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:00:31,350 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:31,350 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:00:31,351 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:00:31,351 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:31,351 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:00:31,352 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:00:31,352 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:00:32,344 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:00:32,344 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:00:32,344 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:00:32,345 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:00:32,347 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:00:32,347 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:00:32,347 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:00:32,347 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:00:32,348 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:00:32,348 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:00:32,348 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:00:32,348 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:00:32,348 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:00:32,349 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:00:32,350 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:00:32,350 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:00:32,350 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:00:32,350 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:00:32,350 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:00:32,351 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:00:32,351 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:00:32,351 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:00:32,352 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:00:32,353 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:00:32,353 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:00:32,353 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:00:32,353 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:00:32,353 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:00:33,056 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:00:33,057 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:00:33,057 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:00:33,059 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:00:33,059 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:00:33,097 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:00:33,098 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:00:33,100 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:00:33,100 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:00:33,100 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:33,101 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:00:33,101 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980033.0986516}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980033.1001384}}
2025-09-04 13:00:33,101 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:33,101 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:00:33,102 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980033.0986516}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980033.1001384}
2025-09-04 13:00:33,102 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:33,102 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:00:33,102 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:00:35,128 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:00:35,129 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 13:00:35,129 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 13:00:35,131 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:00:35,131 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:00:35,131 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:00:35,132 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 13:00:35,132 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 13:00:35,133 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=25.0
2025-09-04 13:00:35,133 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:35,134 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:00:35,134 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980035.1334507}}
2025-09-04 13:00:35,136 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:35,136 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:00:35,136 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980035.1334507}
2025-09-04 13:00:35,137 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:35,137 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:00:35,138 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 13:00:37,037 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT message
2025-09-04 13:00:37,037 - controller.services.websocket_client - INFO - Full message: {"type":"IRRIGATE_PLANT","data":{"plant_id":219,"session_id":"c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4"}}
2025-09-04 13:00:37,038 - controller.services.websocket_client - INFO - Parsed data: {'type': 'IRRIGATE_PLANT', 'data': {'plant_id': 219, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:37,038 - controller.services.websocket_client - INFO - Message type: 'IRRIGATE_PLANT' (length: 14)
2025-09-04 13:00:37,038 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:37,039 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT request for plant 219
2025-09-04 13:00:37,039 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:37,041 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_ACCEPTED
2025-09-04 13:00:37,041 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_ACCEPTED', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:37,041 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:37,041 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'session_id']
2025-09-04 13:00:37,042 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:37,042 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:37,043 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_ACCEPTED message
2025-09-04 13:00:37,043 - controller.services.websocket_client - INFO - Started background irrigation task for plant 219
2025-09-04 13:00:37,045 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:37,045 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:00:37,045 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 46.0%)', 'details': None, 'timestamp': 1756980037.0443554, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:37,046 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:37,046 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:00:37,046 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 46.0%)', 'details': None, 'timestamp': 1756980037.0443554, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:37,047 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:37,047 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:00:37,052 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:00:37,052 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: IRRIGATE_PLANT_ACCEPTED"}
2025-09-04 13:00:37,052 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: IRRIGATE_PLANT_ACCEPTED'}
2025-09-04 13:00:37,053 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:00:37,053 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:00:37,054 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:00:37,054 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:00:37,054 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:00:37,055 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:00:37,055 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:00:37,739 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:37,739 - controller.services.websocket_client - INFO - Message type: IRRIGATION_DECISION
2025-09-04 13:00:37,740 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_DECISION', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:37,740 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:37,742 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'current_moisture', 'target_moisture', 'moisture_gap', 'will_irrigate', 'reason', 'session_id']
2025-09-04 13:00:37,742 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:37,743 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:37,744 - controller.services.websocket_client - INFO - Sent IRRIGATION_DECISION message
2025-09-04 13:00:37,748 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:37,748 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:00:37,749 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980037.7476766, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:37,750 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:37,750 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:00:37,751 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980037.7476766, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:37,751 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:37,753 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:00:47,764 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:47,765 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:00:47,765 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980047.7640104, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:47,765 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:47,765 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:00:47,765 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980047.7640104, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:47,765 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:47,766 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:00:57,784 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:00:57,784 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:00:57,784 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980057.7834568, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:00:57,784 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:00:57,786 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:00:57,786 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980057.7834568, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:00:57,786 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:00:57,787 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:01:07,793 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:07,793 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:01:07,794 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980067.7923095, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:01:07,794 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:07,794 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:01:07,795 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980067.7923095, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:01:07,796 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:07,796 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:01:17,804 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:17,805 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:01:17,806 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980077.8037372, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:01:17,806 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:17,807 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:01:17,807 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980077.8037372, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:01:17,808 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:17,808 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:01:27,829 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:27,829 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:01:27,830 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.3, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980087.8285754, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:01:27,831 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:27,831 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:01:27,832 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.3, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980087.8285754, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:01:27,832 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:27,834 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:01:31,952 - controller.services.websocket_client - INFO - Received STOP_IRRIGATION message
2025-09-04 13:01:31,952 - controller.services.websocket_client - INFO - Full message: {"type":"STOP_IRRIGATION","data":{"plant_id":219,"plant_name":"219"}}
2025-09-04 13:01:31,952 - controller.services.websocket_client - INFO - Parsed data: {'type': 'STOP_IRRIGATION', 'data': {'plant_id': 219, 'plant_name': '219'}}
2025-09-04 13:01:31,953 - controller.services.websocket_client - INFO - Message type: 'STOP_IRRIGATION' (length: 15)
2025-09-04 13:01:31,953 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'plant_name': '219'}
2025-09-04 13:01:33,987 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:33,987 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_RESPONSE
2025-09-04 13:01:33,987 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.3, 'water_added_liters': 0.022222222222222223, 'error_message': None, 'timestamp': 1756980093.987298, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}}
2025-09-04 13:01:33,988 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:33,988 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'reason', 'moisture', 'final_moisture', 'water_added_liters', 'error_message', 'timestamp', 'session_id']
2025-09-04 13:01:33,988 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.3, 'water_added_liters': 0.022222222222222223, 'error_message': None, 'timestamp': 1756980093.987298, 'session_id': 'c242d6c1-0c3f-41ac-ac24-e8651cc8f7a4'}
2025-09-04 13:01:33,988 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:33,988 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_RESPONSE message
2025-09-04 13:01:33,988 - controller.services.websocket_client - INFO - Sent irrigation result for plant 219: success
2025-09-04 13:01:33,990 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:33,990 - controller.services.websocket_client - INFO - Message type: STOP_IRRIGATION_RESPONSE
2025-09-04 13:01:33,991 - controller.services.websocket_client - INFO - Full message: {'type': 'STOP_IRRIGATION_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.3, 'final_moisture': 30.3, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756980093.9903529}}}
2025-09-04 13:01:33,991 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:33,991 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:01:33,991 - controller.services.websocket_client - INFO - Message data values: {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.3, 'final_moisture': 30.3, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756980093.9903529}}
2025-09-04 13:01:33,991 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:33,992 - controller.services.websocket_client - INFO - Sent STOP_IRRIGATION_RESPONSE message
2025-09-04 13:01:33,992 - controller.services.websocket_client - INFO - STOP IRRIGATION SUCCESS: plant=219 final_moisture=30.3 water_added=0.0
2025-09-04 13:01:35,245 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:01:35,245 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:01:35,245 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:01:40,248 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:01:40,248 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:01:40,248 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:01:40,248 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:01:40,251 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:01:40,252 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:40,252 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:01:40,252 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:01:40,252 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:01:40,253 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:01:40,253 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:01:40,253 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:40,253 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:01:41,261 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:01:41,261 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:01:41,261 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:01:41,261 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:01:41,261 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:41,263 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:01:41,263 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:01:41,263 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:41,264 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:01:41,264 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:01:41,265 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:41,265 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:01:41,265 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:01:41,265 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:01:42,283 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:01:42,283 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:01:42,284 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:01:42,284 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:01:42,284 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:01:42,286 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:01:42,286 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:01:42,287 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:01:42,287 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:01:42,288 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:01:42,288 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:01:42,289 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:01:42,289 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:01:42,291 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:01:42,291 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:01:42,292 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:01:42,292 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:01:42,293 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:01:42,293 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:01:42,294 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:01:42,295 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 13:01:42,295 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 13:01:42,296 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:01:42,296 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:01:42,297 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:01:42,297 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 13:01:42,298 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 13:01:42,298 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.3%, temperature=25.0
2025-09-04 13:01:42,299 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:42,299 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:01:42,300 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.3, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980102.2986133}}
2025-09-04 13:01:42,300 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:42,301 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:01:42,301 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.3, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980102.2986133}
2025-09-04 13:01:42,302 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:42,304 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:01:42,304 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.3%
2025-09-04 13:01:42,305 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:01:42,305 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:01:42,305 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:01:42,307 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:01:42,307 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:01:42,308 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:01:42,309 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:01:42,310 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:01:42,310 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:01:42,311 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:01:42,312 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:01:42,312 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:01:42,313 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:01:42,314 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:01:42,314 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:01:42,315 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:01:42,315 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:01:42,315 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:01:42,316 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:01:42,317 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:01:42,317 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:01:42,317 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:01:42,318 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:01:42,318 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:01:42,318 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:01:42,318 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:01:42,319 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:01:42,319 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:01:42,319 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:01:46,219 - controller.services.websocket_client - INFO - Received OPEN_VALVE message
2025-09-04 13:01:46,220 - controller.services.websocket_client - INFO - Full message: {"type":"OPEN_VALVE","data":{"plant_id":219,"time_minutes":15}}
2025-09-04 13:01:46,220 - controller.services.websocket_client - INFO - Parsed data: {'type': 'OPEN_VALVE', 'data': {'plant_id': 219, 'time_minutes': 15}}
2025-09-04 13:01:46,221 - controller.services.websocket_client - INFO - Message type: 'OPEN_VALVE' (length: 10)
2025-09-04 13:01:46,221 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'time_minutes': 15}
2025-09-04 13:01:46,221 - controller.services.websocket_client - INFO - Received OPEN_VALVE request for plant 219, duration: 15 minutes
2025-09-04 13:01:46,227 - controller.services.websocket_client - INFO - === OPEN_VALVE RESPONSE DEBUG ===
2025-09-04 13:01:46,227 - controller.services.websocket_client - INFO - Result status: success
2025-09-04 13:01:46,227 - controller.services.websocket_client - INFO - Result reason: Valve opened for plant 219 for 15 minutes
2025-09-04 13:01:46,229 - controller.services.websocket_client - INFO - Result error_message: None
2025-09-04 13:01:46,229 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 13:01:46,230 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 219, 'time_minutes': 15, 'status': 'success', 'timestamp': 1756980106.227384, 'message': 'Valve opened for plant 219 for 15 minutes', 'reason': 'Valve opened for plant 219 for 15 minutes'}
2025-09-04 13:01:46,230 - controller.services.websocket_client - INFO - ====================================
2025-09-04 13:01:46,231 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:46,232 - controller.services.websocket_client - INFO - Message type: OPEN_VALVE_RESPONSE
2025-09-04 13:01:46,232 - controller.services.websocket_client - INFO - Full message: {'type': 'OPEN_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'time_minutes': 15, 'status': 'success', 'timestamp': 1756980106.227384, 'message': 'Valve opened for plant 219 for 15 minutes', 'reason': 'Valve opened for plant 219 for 15 minutes'}}
2025-09-04 13:01:46,233 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:46,233 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 13:01:46,234 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'time_minutes': 15, 'status': 'success', 'timestamp': 1756980106.227384, 'message': 'Valve opened for plant 219 for 15 minutes', 'reason': 'Valve opened for plant 219 for 15 minutes'}
2025-09-04 13:01:46,235 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:46,236 - controller.services.websocket_client - INFO - Sent OPEN_VALVE_RESPONSE message
2025-09-04 13:01:46,236 - controller.services.websocket_client - INFO - Open valve request completed for plant 219: success
2025-09-04 13:01:55,475 - controller.services.websocket_client - INFO - Received CLOSE_VALVE message
2025-09-04 13:01:55,475 - controller.services.websocket_client - INFO - Full message: {"type":"CLOSE_VALVE","data":{"plant_id":219}}
2025-09-04 13:01:55,476 - controller.services.websocket_client - INFO - Parsed data: {'type': 'CLOSE_VALVE', 'data': {'plant_id': 219}}
2025-09-04 13:01:55,476 - controller.services.websocket_client - INFO - Message type: 'CLOSE_VALVE' (length: 11)
2025-09-04 13:01:55,476 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:01:55,476 - controller.services.websocket_client - INFO - Received CLOSE_VALVE request for plant 219
2025-09-04 13:01:55,478 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:01:55,478 - controller.services.websocket_client - INFO - Message type: CLOSE_VALVE_RESPONSE
2025-09-04 13:01:55,478 - controller.services.websocket_client - INFO - Full message: {'type': 'CLOSE_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}}
2025-09-04 13:01:55,478 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:01:55,479 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:01:55,479 - controller.services.websocket_client - INFO - Message data values: {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}
2025-09-04 13:01:55,479 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:01:55,480 - controller.services.websocket_client - INFO - Sent CLOSE_VALVE_RESPONSE message
2025-09-04 13:01:55,480 - controller.services.websocket_client - INFO - Successfully closed valve for plant 219
2025-09-04 13:02:06,337 - controller.services.websocket_client - INFO - Received UPDATE_PLANT message
2025-09-04 13:02:06,338 - controller.services.websocket_client - INFO - Full message: {"type":"UPDATE_PLANT","data":{"plant_id":219,"plant_name":"Plant1","desired_moisture":55,"water_limit":1,"dripper_type":"2L/h"}}
2025-09-04 13:02:06,338 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UPDATE_PLANT', 'data': {'plant_id': 219, 'plant_name': 'Plant1', 'desired_moisture': 55, 'water_limit': 1, 'dripper_type': '2L/h'}}
2025-09-04 13:02:06,338 - controller.services.websocket_client - INFO - Message type: 'UPDATE_PLANT' (length: 12)
2025-09-04 13:02:06,338 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'plant_name': 'Plant1', 'desired_moisture': 55, 'water_limit': 1, 'dripper_type': '2L/h'}
2025-09-04 13:02:06,342 - controller.services.websocket_client - INFO - Received UPDATE_PLANT command from server
2025-09-04 13:02:06,342 - controller.services.websocket_client - INFO - Full message: {'type': 'UPDATE_PLANT', 'data': {'plant_id': 219, 'plant_name': 'Plant1', 'desired_moisture': 55, 'water_limit': 1, 'dripper_type': '2L/h'}}
2025-09-04 13:02:06,342 - controller.handlers.update_plant_handler - INFO - Updating plant 219 with new settings
2025-09-04 13:02:06,343 - controller.handlers.update_plant_handler - INFO - Successfully updated plant 219
2025-09-04 13:02:06,343 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:06,343 - controller.services.websocket_client - INFO - Message type: UPDATE_PLANT_RESPONSE
2025-09-04 13:02:06,343 - controller.services.websocket_client - INFO - Full message: {'type': 'UPDATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'success': True, 'message': 'Plant 219 updated successfully'}}
2025-09-04 13:02:06,343 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:06,343 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'success', 'message']
2025-09-04 13:02:06,343 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'success': True, 'message': 'Plant 219 updated successfully'}
2025-09-04 13:02:06,345 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:06,345 - controller.services.websocket_client - INFO - Sent UPDATE_PLANT_RESPONSE message
2025-09-04 13:02:06,345 - controller.services.websocket_client - INFO - Successfully updated plant 219
2025-09-04 13:02:06,374 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:02:06,374 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: UPDATE_PLANT_RESPONSE"}
2025-09-04 13:02:06,374 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: UPDATE_PLANT_RESPONSE'}
2025-09-04 13:02:06,375 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:02:06,375 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:02:06,375 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:02:06,375 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:02:06,376 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:02:06,376 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:02:06,376 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:02:09,192 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:02:09,193 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:02:09,193 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:02:09,193 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:02:09,194 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:02:09,195 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:02:09,195 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:02:09,195 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:02:09,196 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:02:09,196 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:09,196 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:02:09,197 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980129.1953104}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980129.1963112}}
2025-09-04 13:02:09,197 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:09,197 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:02:09,197 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980129.1953104}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980129.1963112}
2025-09-04 13:02:09,198 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:09,198 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:02:09,199 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:02:26,370 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:02:26,370 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:02:26,370 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:02:26,371 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:02:26,371 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:02:26,371 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:02:26,371 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:02:26,372 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:02:26,372 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:02:26,372 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:26,372 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:02:26,372 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980146.3725808}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980146.3725808}}
2025-09-04 13:02:26,373 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:26,373 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:02:26,373 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980146.3725808}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980146.3725808}
2025-09-04 13:02:26,373 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:26,374 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:02:26,374 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:02:32,098 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:02:32,098 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 13:02:32,098 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 13:02:32,099 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:02:32,099 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:02:32,100 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:02:32,100 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 13:02:32,100 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 13:02:32,101 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=25.0
2025-09-04 13:02:32,101 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:32,101 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:02:32,103 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980152.1019378}}
2025-09-04 13:02:32,103 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:32,103 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:02:32,104 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980152.1019378}
2025-09-04 13:02:32,104 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:32,105 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:02:32,105 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 13:02:33,869 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT message
2025-09-04 13:02:33,870 - controller.services.websocket_client - INFO - Full message: {"type":"IRRIGATE_PLANT","data":{"plant_id":219,"session_id":"b542b342-89ec-49c7-8bff-6d3d20afcf9c"}}
2025-09-04 13:02:33,870 - controller.services.websocket_client - INFO - Parsed data: {'type': 'IRRIGATE_PLANT', 'data': {'plant_id': 219, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}}
2025-09-04 13:02:33,870 - controller.services.websocket_client - INFO - Message type: 'IRRIGATE_PLANT' (length: 14)
2025-09-04 13:02:33,870 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}
2025-09-04 13:02:33,870 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT request for plant 219
2025-09-04 13:02:33,871 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:33,871 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_ACCEPTED
2025-09-04 13:02:33,871 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_ACCEPTED', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}}
2025-09-04 13:02:33,872 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:33,872 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'session_id']
2025-09-04 13:02:33,872 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}
2025-09-04 13:02:33,872 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:33,874 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_ACCEPTED message
2025-09-04 13:02:33,874 - controller.services.websocket_client - INFO - Started background irrigation task for plant 219
2025-09-04 13:02:33,875 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:33,875 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:02:33,876 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 46.0%)', 'details': None, 'timestamp': 1756980153.8753383, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}}
2025-09-04 13:02:33,876 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:33,876 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:02:33,877 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 46.0%)', 'details': None, 'timestamp': 1756980153.8753383, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}
2025-09-04 13:02:33,877 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:33,877 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:02:33,878 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:02:33,879 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: IRRIGATE_PLANT_ACCEPTED"}
2025-09-04 13:02:33,881 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: IRRIGATE_PLANT_ACCEPTED'}
2025-09-04 13:02:33,882 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:02:33,882 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:02:33,883 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:02:33,883 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:02:33,884 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:02:33,884 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:02:33,884 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:02:34,544 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:34,544 - controller.services.websocket_client - INFO - Message type: IRRIGATION_DECISION
2025-09-04 13:02:34,545 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_DECISION', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}}
2025-09-04 13:02:34,545 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:34,546 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'current_moisture', 'target_moisture', 'moisture_gap', 'will_irrigate', 'reason', 'session_id']
2025-09-04 13:02:34,546 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': 16.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}
2025-09-04 13:02:34,547 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:34,547 - controller.services.websocket_client - INFO - Sent IRRIGATION_DECISION message
2025-09-04 13:02:34,550 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:34,551 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:02:34,551 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980154.550262, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}}
2025-09-04 13:02:34,551 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:34,552 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:02:34,552 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 46.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756980154.550262, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}
2025-09-04 13:02:34,553 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:34,553 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:02:39,863 - controller.services.websocket_client - INFO - Received STOP_IRRIGATION message
2025-09-04 13:02:39,864 - controller.services.websocket_client - INFO - Full message: {"type":"STOP_IRRIGATION","data":{"plant_id":219,"plant_name":"219"}}
2025-09-04 13:02:39,864 - controller.services.websocket_client - INFO - Parsed data: {'type': 'STOP_IRRIGATION', 'data': {'plant_id': 219, 'plant_name': '219'}}
2025-09-04 13:02:39,865 - controller.services.websocket_client - INFO - Message type: 'STOP_IRRIGATION' (length: 15)
2025-09-04 13:02:39,865 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'plant_name': '219'}
2025-09-04 13:02:41,888 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:41,888 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_RESPONSE
2025-09-04 13:02:41,889 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756980161.8884194, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}}
2025-09-04 13:02:41,889 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:41,889 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'reason', 'moisture', 'final_moisture', 'water_added_liters', 'error_message', 'timestamp', 'session_id']
2025-09-04 13:02:41,889 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756980161.8884194, 'session_id': 'b542b342-89ec-49c7-8bff-6d3d20afcf9c'}
2025-09-04 13:02:41,890 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:41,890 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_RESPONSE message
2025-09-04 13:02:41,890 - controller.services.websocket_client - INFO - Sent irrigation result for plant 219: success
2025-09-04 13:02:41,894 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:41,894 - controller.services.websocket_client - INFO - Message type: STOP_IRRIGATION_RESPONSE
2025-09-04 13:02:41,894 - controller.services.websocket_client - INFO - Full message: {'type': 'STOP_IRRIGATION_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756980161.8940024}}}
2025-09-04 13:02:41,894 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:41,894 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:02:41,895 - controller.services.websocket_client - INFO - Message data values: {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 219, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756980161.8940024}}
2025-09-04 13:02:41,895 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:41,895 - controller.services.websocket_client - INFO - Sent STOP_IRRIGATION_RESPONSE message
2025-09-04 13:02:41,895 - controller.services.websocket_client - INFO - STOP IRRIGATION SUCCESS: plant=219 final_moisture=30.0 water_added=0.0
2025-09-04 13:02:42,842 - controller.services.websocket_client - INFO - Received OPEN_VALVE message
2025-09-04 13:02:42,842 - controller.services.websocket_client - INFO - Full message: {"type":"OPEN_VALVE","data":{"plant_id":219,"time_minutes":45}}
2025-09-04 13:02:42,842 - controller.services.websocket_client - INFO - Parsed data: {'type': 'OPEN_VALVE', 'data': {'plant_id': 219, 'time_minutes': 45}}
2025-09-04 13:02:42,842 - controller.services.websocket_client - INFO - Message type: 'OPEN_VALVE' (length: 10)
2025-09-04 13:02:42,843 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'time_minutes': 45}
2025-09-04 13:02:42,843 - controller.services.websocket_client - INFO - Received OPEN_VALVE request for plant 219, duration: 45 minutes
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - === OPEN_VALVE RESPONSE DEBUG ===
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - Result status: success
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - Result reason: Valve opened for plant 219 for 45 minutes
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - Result error_message: None
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 219, 'time_minutes': 45, 'status': 'success', 'timestamp': 1756980162.8448904, 'message': 'Valve opened for plant 219 for 45 minutes', 'reason': 'Valve opened for plant 219 for 45 minutes'}
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - ====================================
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:02:42,844 - controller.services.websocket_client - INFO - Message type: OPEN_VALVE_RESPONSE
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - Full message: {'type': 'OPEN_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'time_minutes': 45, 'status': 'success', 'timestamp': 1756980162.8448904, 'message': 'Valve opened for plant 219 for 45 minutes', 'reason': 'Valve opened for plant 219 for 45 minutes'}}
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'time_minutes': 45, 'status': 'success', 'timestamp': 1756980162.8448904, 'message': 'Valve opened for plant 219 for 45 minutes', 'reason': 'Valve opened for plant 219 for 45 minutes'}
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - Sent OPEN_VALVE_RESPONSE message
2025-09-04 13:02:42,845 - controller.services.websocket_client - INFO - Open valve request completed for plant 219: success
2025-09-04 13:03:05,392 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:03:05,393 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:03:05,393 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:03:10,406 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:03:10,407 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:03:10,407 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:03:10,408 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:03:10,411 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:03:10,411 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:03:10,411 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:03:10,412 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:03:10,412 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:03:10,413 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:03:10,413 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:03:10,413 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:03:10,414 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:03:11,421 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:03:11,421 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:03:11,422 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:03:11,422 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:03:11,422 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:03:11,423 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:03:11,423 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:03:11,423 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:03:11,423 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:03:11,423 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:03:11,424 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:03:11,424 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:03:11,424 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:03:11,424 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:03:12,445 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:03:12,446 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:03:12,446 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:03:12,446 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:03:12,446 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:03:12,447 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:03:12,448 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:03:12,449 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:03:12,449 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:03:12,449 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:03:12,449 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:03:12,449 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:03:12,449 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:03:12,450 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:03:12,451 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:03:12,451 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:03:12,451 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:03:12,451 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:03:12,451 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:03:12,451 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:04:16,576 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:04:16,577 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:04:16,577 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:04:16,577 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:04:16,577 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:04:16,577 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:04:16,577 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:04:16,578 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:04:16,578 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:04:16,578 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:16,579 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:04:16,579 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980256.5785675}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980256.5785675}}
2025-09-04 13:04:16,579 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:16,580 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:04:16,580 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980256.5785675}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980256.5785675}
2025-09-04 13:04:16,580 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:16,581 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:04:16,581 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:04:19,937 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:04:19,937 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 13:04:19,938 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 13:04:19,938 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:04:19,938 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:04:19,938 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:04:19,939 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 13:04:19,939 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 13:04:19,939 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=25.0
2025-09-04 13:04:19,939 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:19,940 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:04:19,940 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980259.9394202}}
2025-09-04 13:04:19,940 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:19,940 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:04:19,941 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980259.9394202}
2025-09-04 13:04:19,941 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:19,941 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:04:19,941 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 13:04:21,870 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:04:21,870 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:04:21,871 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:04:21,871 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:04:21,871 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:04:21,872 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:04:21,872 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:04:21,873 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:04:21,873 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:04:21,873 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:21,874 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:04:21,874 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980261.872593}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980261.8736172}}
2025-09-04 13:04:21,874 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:21,874 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:04:21,875 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980261.872593}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980261.8736172}
2025-09-04 13:04:21,875 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:21,875 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:04:21,876 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:04:22,562 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:04:22,562 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 13:04:22,562 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 13:04:22,562 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:04:22,563 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:04:22,563 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:04:22,563 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 13:04:22,563 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 13:04:22,564 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=25.0
2025-09-04 13:04:22,564 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:22,564 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:04:22,564 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980262.5647528}}
2025-09-04 13:04:22,565 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:22,565 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:04:22,565 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980262.5647528}
2025-09-04 13:04:22,565 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:22,565 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:04:22,565 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 13:04:23,432 - controller.services.websocket_client - INFO - Received CLOSE_VALVE message
2025-09-04 13:04:23,432 - controller.services.websocket_client - INFO - Full message: {"type":"CLOSE_VALVE","data":{"plant_id":219}}
2025-09-04 13:04:23,433 - controller.services.websocket_client - INFO - Parsed data: {'type': 'CLOSE_VALVE', 'data': {'plant_id': 219}}
2025-09-04 13:04:23,433 - controller.services.websocket_client - INFO - Message type: 'CLOSE_VALVE' (length: 11)
2025-09-04 13:04:23,433 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:04:23,433 - controller.services.websocket_client - INFO - Received CLOSE_VALVE request for plant 219
2025-09-04 13:04:23,435 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:23,435 - controller.services.websocket_client - INFO - Message type: CLOSE_VALVE_RESPONSE
2025-09-04 13:04:23,435 - controller.services.websocket_client - INFO - Full message: {'type': 'CLOSE_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}}
2025-09-04 13:04:23,435 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:23,437 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:04:23,437 - controller.services.websocket_client - INFO - Message data values: {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}
2025-09-04 13:04:23,437 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:23,438 - controller.services.websocket_client - INFO - Sent CLOSE_VALVE_RESPONSE message
2025-09-04 13:04:23,438 - controller.services.websocket_client - INFO - Successfully closed valve for plant 219
2025-09-04 13:04:24,930 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:04:24,930 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:04:24,930 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:04:24,930 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:04:24,930 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:04:24,930 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:04:24,930 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:04:24,931 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:04:24,931 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980264.9300292}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980264.9310281}}
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756980264.9300292}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756980264.9310281}
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:24,931 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:04:24,932 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:04:35,404 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:04:35,405 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:04:35,405 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:04:40,414 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:04:40,414 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:04:40,414 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:04:40,414 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:40,417 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:04:41,425 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:04:41,426 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:04:41,426 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:04:41,426 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:04:41,426 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:04:41,426 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:04:41,427 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:04:41,427 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:04:41,427 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:04:41,427 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:04:41,427 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:04:41,428 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:04:41,428 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:04:41,428 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:04:42,441 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:04:42,441 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:04:42,441 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:04:42,441 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:04:42,442 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:04:42,442 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:04:42,442 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:04:42,442 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:04:42,442 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:04:42,442 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:04:42,443 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:04:42,444 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:04:42,445 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:04:42,445 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:04:42,445 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:04:42,445 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:04:42,445 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:04:42,445 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:04:42,446 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:04:42,448 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:04:42,448 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:04:42,448 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:04:42,448 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:04:42,448 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:04:42,448 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:04:42,448 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:04:42,449 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:04:42,449 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:04:42,449 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:04:42,449 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:06:05,428 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:06:05,428 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:06:05,428 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:06:10,445 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:06:10,445 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:06:10,447 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:06:10,447 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:06:10,460 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:06:10,460 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:06:10,460 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:06:10,460 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:06:10,462 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:06:10,462 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:06:10,462 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:06:10,463 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:06:10,463 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:06:11,474 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:06:11,474 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:06:11,474 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:06:11,474 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:06:11,475 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:06:11,475 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:06:11,475 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:06:11,475 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:06:11,476 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:06:11,476 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:06:11,476 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:06:11,476 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:06:11,477 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:06:11,477 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:06:12,492 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:06:12,492 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:06:12,492 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:06:12,492 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:06:12,492 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:06:12,493 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:06:12,495 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:06:12,495 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:06:12,495 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:06:12,495 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:06:12,496 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:06:12,496 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:06:12,496 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:06:12,496 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:06:12,497 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:06:12,497 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:06:12,497 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:06:12,497 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:06:12,498 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:06:12,499 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:06:12,500 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:06:12,501 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:06:12,501 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:06:12,501 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:06:12,501 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:06:12,502 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:06:12,502 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:06:12,502 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:06:12,502 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:06:12,504 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:06:12,504 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:06:12,504 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:06:12,504 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:06:12,504 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:07:35,462 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:07:35,462 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:07:35,462 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:07:40,468 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:07:40,468 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:07:40,469 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:07:40,469 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:07:40,472 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:07:40,472 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:07:40,472 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:07:40,472 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:07:40,472 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:07:40,473 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:07:40,473 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:07:40,473 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:07:40,473 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:07:41,490 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:07:41,490 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:07:41,490 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:07:41,490 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:07:41,490 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:07:41,491 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:07:41,491 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:07:41,491 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:07:41,491 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:07:41,491 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:07:41,491 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:07:41,492 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:07:41,492 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:07:41,492 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:07:42,485 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:07:42,486 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:07:42,487 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:07:42,487 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:07:42,487 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:07:42,488 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:07:42,488 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:07:42,489 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:07:42,489 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:07:42,490 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:07:42,490 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:07:42,492 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:07:42,492 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:07:42,493 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:07:42,493 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:07:42,494 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:07:42,494 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:07:42,495 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:07:42,495 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:07:42,496 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:07:42,496 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:07:42,498 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:07:42,498 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:07:42,498 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:07:42,499 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:07:42,499 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:07:42,500 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:07:42,500 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:07:42,502 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:07:42,503 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:07:42,503 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:07:42,504 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:07:42,504 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:07:42,504 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:07:42,505 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:07:42,507 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:07:42,507 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:07:42,508 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:07:42,508 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:07:42,509 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:07:42,509 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:07:42,510 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:07:42,510 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:07:42,511 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:07:42,511 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:07:42,512 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:07:42,512 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:07:42,513 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:09:05,486 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:09:05,487 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:09:05,487 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:09:10,498 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:09:10,498 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:09:10,498 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:09:10,499 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:09:10,502 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:09:10,504 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:09:10,504 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:09:10,504 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:09:10,504 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:09:10,504 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:09:10,505 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:09:10,505 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:09:10,505 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:09:11,511 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:09:11,513 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:09:11,513 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:09:11,513 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:09:11,513 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:09:11,513 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:09:11,513 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:09:11,515 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:09:11,515 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:09:11,515 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:09:11,515 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:09:11,515 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:09:11,515 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:09:11,516 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:09:12,527 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:09:12,527 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:09:12,528 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:09:12,528 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:09:12,529 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:09:12,529 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:09:12,529 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:09:12,529 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:09:12,530 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:09:12,530 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:09:12,530 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:09:12,531 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:09:12,531 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:09:12,531 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:09:12,531 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:09:12,532 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:09:12,532 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:09:12,532 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:09:12,533 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:09:12,535 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:09:12,535 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:09:12,535 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:09:12,535 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:09:12,535 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:09:12,536 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:09:12,536 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:09:12,536 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:09:12,536 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:09:12,536 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:09:12,536 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:09:12,537 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:09:12,537 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:09:12,537 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:09:12,537 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:09:12,537 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:09:12,537 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:09:12,537 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:09:12,537 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:09:12,537 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:09:12,537 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:09:12,537 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:10:35,503 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:10:35,503 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:10:35,505 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:10:40,514 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:10:40,514 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:10:40,537 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:10:40,538 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:10:40,563 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:10:40,587 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:10:40,587 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:10:40,587 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:10:40,588 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:10:40,588 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:10:40,588 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:10:40,588 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:10:40,589 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:10:41,598 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:10:41,598 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:10:41,598 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:10:41,598 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:10:41,600 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:10:41,600 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:10:41,600 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:10:41,600 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:10:41,600 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:10:41,601 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:10:41,601 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:10:41,601 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:10:41,601 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:10:41,602 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:10:42,607 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:10:42,607 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:10:42,607 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:10:42,608 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:10:42,608 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:10:42,608 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:10:42,608 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:10:42,608 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:10:42,609 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:10:42,609 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:10:42,609 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:10:42,609 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:10:42,609 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:10:42,609 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:10:42,611 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:10:42,611 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:10:42,611 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:10:42,611 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:10:42,611 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:10:42,612 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:10:42,612 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:10:42,612 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:10:42,612 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:10:42,612 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:10:42,613 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:10:42,613 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:10:42,613 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:10:42,613 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:10:42,613 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:10:42,614 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:10:42,614 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:10:42,614 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:10:42,614 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:10:42,614 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:10:42,615 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:10:42,615 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:10:42,615 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:10:42,615 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:10:42,616 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:10:42,616 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:10:42,616 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:10:42,616 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:10:42,617 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:10:42,617 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:10:42,617 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:10:42,617 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:10:42,617 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:10:42,617 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:12:05,519 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:12:05,523 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:12:05,523 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:12:10,535 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:12:10,535 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:12:10,535 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:12:10,535 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:12:10,539 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:12:10,540 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:12:10,540 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:12:10,540 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:12:10,540 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:12:10,540 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:12:10,540 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:12:10,541 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:12:10,541 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:12:11,546 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:12:11,546 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:12:11,547 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:12:11,547 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:12:11,547 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:12:11,547 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:12:11,547 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:12:11,548 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:12:11,548 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:12:11,548 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:12:11,548 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:12:11,549 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:12:11,549 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:12:11,549 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:12:12,564 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:12:12,564 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:12:12,564 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:12:12,565 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:12:12,567 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:12:12,567 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:12:12,567 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:12:12,567 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:12:12,567 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:12:12,567 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:12:12,568 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:12:12,568 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:12:12,568 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:12:12,568 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:12:12,568 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:12:12,569 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:12:12,570 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:12:12,570 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:12:12,570 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:12:12,570 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:12:12,570 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:12:12,570 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:12:12,572 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:12:12,572 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:12:12,572 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:12:12,573 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:12:12,573 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:12:12,573 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:12:12,573 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:12:12,573 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:12:12,574 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:12:12,574 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:12:12,574 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:12:12,574 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:12:12,574 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:12:12,574 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:13:35,534 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:13:35,534 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:13:35,534 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:13:40,546 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:13:40,547 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:13:40,547 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:13:40,548 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:13:40,555 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:13:40,556 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:13:40,557 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:13:40,557 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:13:40,558 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:13:40,558 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:13:40,559 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:13:40,560 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:13:40,560 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:13:41,573 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:13:41,573 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:13:41,573 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:13:41,574 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:13:41,574 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:13:41,574 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:13:41,574 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:13:41,574 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:13:41,575 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:13:41,575 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:13:41,575 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:13:41,575 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:13:41,576 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:13:41,576 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:13:42,586 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:13:42,597 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:13:42,597 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:13:42,604 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:13:42,604 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:13:42,605 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:13:42,605 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:13:42,605 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:13:42,605 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:13:42,605 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:13:42,605 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:13:42,607 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:13:42,607 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:13:42,607 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:13:42,607 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:13:42,608 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:13:42,608 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:13:42,608 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:13:42,608 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:13:42,608 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:13:42,609 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:13:42,611 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:13:42,612 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:13:42,613 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:13:42,613 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:13:42,613 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:13:42,613 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:13:42,613 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:13:42,613 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:13:42,614 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:13:42,614 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:13:42,614 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:13:42,614 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:13:42,614 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:13:42,614 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:13:42,614 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:13:42,614 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:13:42,615 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:13:42,615 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:13:42,615 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:15:05,548 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:15:05,548 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:15:05,549 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:15:10,564 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:15:10,564 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:15:10,566 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:15:10,566 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:15:10,576 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:15:10,576 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:15:10,577 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:15:10,578 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:15:10,578 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:15:10,579 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:15:10,579 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:15:10,580 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:15:10,580 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:15:11,585 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:15:11,585 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:15:11,585 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:15:11,586 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:15:11,586 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:15:11,587 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:15:11,587 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:15:11,587 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:15:11,588 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:15:11,588 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:15:11,589 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:15:11,589 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:15:11,589 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:15:11,591 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:15:12,583 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:15:12,584 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:15:12,584 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:15:12,585 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:15:12,585 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:15:12,587 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:15:12,587 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:15:12,587 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:15:12,588 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:15:12,588 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:15:12,589 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:15:12,589 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:15:12,589 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:15:12,590 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:15:12,590 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:15:12,592 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:15:12,592 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:15:12,593 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:15:12,593 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:15:12,594 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:15:12,595 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:15:12,595 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:15:12,597 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:15:12,597 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:15:12,598 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:15:12,598 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:15:12,598 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:15:12,599 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:15:12,600 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:15:12,600 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:15:12,600 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:15:12,602 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:15:12,603 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:15:12,603 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:15:12,604 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:15:12,605 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:15:12,605 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:15:12,606 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:15:12,606 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:15:12,607 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:15:12,607 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:15:12,608 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:15:12,608 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:15:12,609 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:15:12,609 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:15:12,611 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:15:12,611 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:15:12,612 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:16:25,093 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:16:25,093 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:16:25,094 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:16:30,100 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:16:30,100 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:16:30,101 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:16:30,101 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:16:30,110 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:16:30,111 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:16:30,111 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:16:30,111 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:16:30,111 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:16:30,111 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:16:30,112 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:16:30,112 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:16:30,112 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:16:31,116 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:16:31,116 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:16:31,116 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:16:31,116 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:16:31,117 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:16:31,117 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:16:31,117 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:16:31,117 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:16:31,117 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:16:31,117 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:16:31,118 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:16:31,118 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:16:31,118 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:16:31,118 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:16:32,124 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:16:32,124 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:16:32,124 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:16:32,124 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:16:32,124 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:16:32,124 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:16:32,125 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:16:32,125 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:16:32,125 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:16:32,125 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:16:32,126 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:16:32,126 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:16:32,126 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:16:32,126 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:16:32,126 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:16:32,126 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:16:32,127 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:16:32,127 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:16:32,127 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:16:32,127 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:16:32,128 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:16:32,130 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:16:32,131 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:16:32,131 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:16:32,131 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:16:32,131 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:16:32,131 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:16:32,131 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:16:32,131 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:16:32,131 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:16:36,400 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 13:16:36,406 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 13:16:36,408 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:16:36,408 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 13:16:36,408 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:16:36,408 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 13:16:36,411 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:16:36,411 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 13:16:43,114 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-04 13:16:43,115 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.67:8080
2025-09-04 13:16:43,115 - controller.run_pi_client - INFO - Family Code: IRIS12
2025-09-04 13:16:43,115 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-04 13:16:43,115 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-04 13:16:43,115 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-04 13:16:43,116 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-04 13:16:43,117 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-04 13:16:43,117 - controller.run_pi_client - INFO - Family code configured: IRIS12
2025-09-04 13:16:43,117 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:16:43,117 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:16:43,117 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:16:43,118 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:16:43,151 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:16:43,151 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:16:43,152 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:16:43,152 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:16:43,152 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:16:43,152 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:16:43,152 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:16:43,152 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:16:43,153 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:16:44,166 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:16:44,167 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:16:44,168 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:16:44,168 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:16:44,168 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:16:44,169 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:16:44,169 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:16:44,170 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:16:44,171 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:16:44,171 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:16:44,171 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:16:44,172 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:16:44,172 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:16:44,174 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:16:45,182 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:16:45,182 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:16:45,182 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:16:45,182 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:16:45,182 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:16:45,183 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:16:45,183 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:16:45,183 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:16:45,184 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:16:45,184 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:16:45,184 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:16:45,184 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:16:45,184 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:16:45,185 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:16:45,185 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:16:45,185 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:16:45,185 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:16:45,186 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:16:45,186 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:16:45,186 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:16:45,186 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:16:45,187 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:16:45,187 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:16:45,187 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:16:45,187 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:16:45,187 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:16:45,187 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:16:45,189 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:16:45,189 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:16:45,189 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:16:45,189 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:16:45,189 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:16:45,190 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:16:45,190 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:16:45,191 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:16:45,191 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:16:45,191 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:16:45,191 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:16:45,191 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:16:45,192 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:16:45,192 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:16:45,192 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:16:45,192 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:16:45,192 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:16:45,192 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:16:45,192 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:16:45,193 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:16:45,193 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:17:57,798 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:17:57,800 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:17:57,800 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:18:02,810 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:18:02,810 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:18:02,811 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:18:02,811 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:18:02,822 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:18:02,822 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:18:02,823 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:18:02,823 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:18:02,823 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:18:02,823 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:18:02,824 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:18:02,824 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:18:02,824 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:18:03,818 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:18:03,818 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:18:03,818 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:18:03,819 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:18:03,819 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:18:03,819 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:18:03,819 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:18:03,819 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:18:03,819 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:18:03,820 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:18:03,820 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:18:03,820 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:18:03,820 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:18:03,820 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:18:04,830 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:18:04,830 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:18:04,830 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:18:04,830 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:18:04,830 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:18:04,831 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:18:04,831 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:18:04,831 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:18:04,831 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:18:04,831 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:18:04,832 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:04,834 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:18:04,834 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:18:04,834 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:18:04,834 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:18:04,835 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:18:04,836 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:18:04,836 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:18:04,836 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:18:04,836 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:18:04,836 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:18:04,838 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:18:04,838 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:18:04,838 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:18:04,838 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:18:04,839 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:18:04,839 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:18:04,839 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:18:04,839 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:18:04,839 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:04,839 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:18:04,839 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:18:04,841 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:18:04,841 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:18:04,841 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:18:28,847 - controller.run_pi_client - INFO - Smart Garden Pi Client starting...
2025-09-04 13:18:28,847 - controller.run_pi_client - INFO - Server URL: ws://192.168.68.67:8080
2025-09-04 13:18:28,847 - controller.run_pi_client - INFO - Family Code: PALM89
2025-09-04 13:18:28,847 - controller.run_pi_client - INFO - Total Valves: 2
2025-09-04 13:18:28,848 - controller.run_pi_client - INFO - Total Sensors: 2
2025-09-04 13:18:28,848 - controller.run_pi_client - INFO - Simulation Mode: True
2025-09-04 13:18:28,848 - controller.run_pi_client - INFO - Initializing Smart Garden Engine with 2 valves and 2 sensors
2025-09-04 13:18:28,849 - controller.run_pi_client - INFO - Smart Garden Engine initialized and ready
2025-09-04 13:18:28,850 - controller.run_pi_client - INFO - Family code configured: PALM89
2025-09-04 13:18:28,850 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:18:28,850 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:18:28,850 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:18:28,850 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:18:28,907 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:18:28,907 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:18:28,907 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:18:28,907 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:18:28,908 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:18:28,908 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:18:28,908 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:18:28,908 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:18:28,909 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:18:29,918 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: PALM89
2025-09-04 13:18:29,919 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:18:29,919 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: PALM89
2025-09-04 13:18:29,919 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:18:29,920 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:18:29,920 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:18:29,920 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'PALM89'}}
2025-09-04 13:18:29,921 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:18:29,921 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:18:29,921 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'PALM89'}
2025-09-04 13:18:29,921 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:18:29,921 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:18:29,923 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: PALM89
2025-09-04 13:18:29,923 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:18:30,926 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:18:30,927 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:18:30,927 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:18:30,927 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:18:30,929 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:18:30,929 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:18:30,929 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:18:30,931 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:18:30,931 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:18:30,931 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:18:30,932 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:18:30,932 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:18:30,932 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:18:30,934 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:18:30,934 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:18:30,935 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:18:30,935 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:18:30,936 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:30,936 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:18:30,937 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:18:30,937 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"Ashurov","invite_code":"PALM89"},"plants":[{"plant_id":214,"desiredMoisture":60,"waterLimit":0.6,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}},{"plant_id":212,"desiredMoisture":60,"waterLimit":0.1,"dripperType":"8L/h","sensor_port":"/dev/ttyUSB1","valve_id":"2","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}}]}
2025-09-04 13:18:30,939 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:18:30,939 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:18:30,940 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:30,940 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:18:30,941 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:18:30,941 - controller.services.websocket_client - INFO - Garden: Ashurov (Code: PALM89)
2025-09-04 13:18:30,942 - controller.services.websocket_client - INFO - Plants to sync: 2
2025-09-04 13:18:30,943 - controller.services.websocket_client - INFO - Adding plant 214 to engine:
2025-09-04 13:18:30,943 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:18:30,945 - controller.services.websocket_client - INFO -   - Water Limit: 0.6L
2025-09-04 13:18:30,945 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:18:30,946 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:18:30,946 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:18:30,947 - controller.services.websocket_client - INFO - Successfully added plant 214 to engine
2025-09-04 13:18:30,948 - controller.services.websocket_client - INFO - Adding plant 212 to engine:
2025-09-04 13:18:30,948 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:18:30,949 - controller.services.websocket_client - INFO -   - Water Limit: 0.1L
2025-09-04 13:18:30,949 - controller.services.websocket_client - INFO -   - Dripper Type: 8L/h
2025-09-04 13:18:30,950 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:18:30,950 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:18:30,951 - controller.services.websocket_client - INFO - Successfully added plant 212 to engine
2025-09-04 13:18:30,952 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:18:30,952 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-04 13:18:30,953 - controller.services.websocket_client - INFO -   - Plant 214: 60.0% target moisture
2025-09-04 13:18:30,953 - controller.services.websocket_client - INFO -   - Plant 212: 60.0% target moisture
2025-09-04 13:18:30,954 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:18:30,954 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:18:30,956 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:18:30,956 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:18:30,957 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:30,958 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:18:30,959 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:18:30,959 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:18:30,960 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:18:30,960 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:18:40,905 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:18:40,905 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:18:40,905 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:18:40,905 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:18:40,905 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:40,972 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:18:40,972 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:18:40,974 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:18:40,975 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:18:40,975 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:18:40,975 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:18:40,975 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981120.9729524}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756981120.9755292}}
2025-09-04 13:18:40,975 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:18:40,976 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:18:40,976 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981120.9729524}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756981120.9755292}
2025-09-04 13:18:40,976 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:18:40,977 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:18:40,977 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:18:54,699 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:18:54,700 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:18:54,700 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:18:54,700 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:18:54,700 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:18:54,715 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:18:54,715 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:18:54,715 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:18:54,716 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:18:54,716 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:18:54,716 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:18:54,716 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:18:54,717 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981134.7157676}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981134.716769}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981134.716769}}
2025-09-04 13:18:54,717 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:18:54,717 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:18:54,717 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981134.7157676}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981134.716769}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981134.716769}
2025-09-04 13:18:54,718 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:18:54,718 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:18:54,718 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:19:01,118 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:19:01,119 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":214}}
2025-09-04 13:19:01,119 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 214}}
2025-09-04 13:19:01,120 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:19:01,120 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214}
2025-09-04 13:19:01,120 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:19:01,121 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 214
2025-09-04 13:19:01,122 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 214 directly from server
2025-09-04 13:19:01,123 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 214: moisture=30.0%, temperature=25.0
2025-09-04 13:19:01,123 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:01,124 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:19:01,124 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981141.1235042}}
2025-09-04 13:19:01,124 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:01,125 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:01,127 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981141.1235042}
2025-09-04 13:19:01,127 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:01,128 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:19:01,129 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 214 = 30.0%
2025-09-04 13:19:03,739 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT message
2025-09-04 13:19:03,772 - controller.services.websocket_client - INFO - Full message: {"type":"IRRIGATE_PLANT","data":{"plant_id":214,"session_id":"03a85c01-f50a-4226-89f7-b9a0deb7d43d"}}
2025-09-04 13:19:03,774 - controller.services.websocket_client - INFO - Parsed data: {'type': 'IRRIGATE_PLANT', 'data': {'plant_id': 214, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:03,819 - controller.services.websocket_client - INFO - Message type: 'IRRIGATE_PLANT' (length: 14)
2025-09-04 13:19:03,943 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:03,982 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT request for plant 214
2025-09-04 13:19:04,093 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:04,129 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_ACCEPTED
2025-09-04 13:19:04,159 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_ACCEPTED', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:04,206 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:04,213 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'session_id']
2025-09-04 13:19:04,226 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:04,229 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:04,249 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_ACCEPTED message
2025-09-04 13:19:04,253 - controller.services.websocket_client - INFO - Started background irrigation task for plant 214
2025-09-04 13:19:04,280 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:04,290 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:19:04,297 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 42.0%)', 'details': None, 'timestamp': 1756981144.278577, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:04,302 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:04,311 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:19:04,317 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 42.0%)', 'details': None, 'timestamp': 1756981144.278577, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:04,337 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:04,348 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:19:04,420 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:19:04,445 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: IRRIGATE_PLANT_ACCEPTED"}
2025-09-04 13:19:04,458 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: IRRIGATE_PLANT_ACCEPTED'}
2025-09-04 13:19:04,478 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:19:04,492 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:04,494 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:19:04,495 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:19:04,542 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:19:04,575 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:19:04,596 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:19:05,128 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:19:05,130 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":219}}
2025-09-04 13:19:05,130 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 219}}
2025-09-04 13:19:05,131 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:19:05,134 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:19:05,135 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:19:05,136 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 219
2025-09-04 13:19:05,139 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 219 directly from server
2025-09-04 13:19:05,141 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 219: moisture=30.0%, temperature=25.0
2025-09-04 13:19:05,142 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:05,142 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:19:05,142 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981145.1414018}}
2025-09-04 13:19:05,143 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:05,143 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:05,143 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981145.1414018}
2025-09-04 13:19:05,143 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:05,144 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:19:05,144 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 219 = 30.0%
2025-09-04 13:19:06,087 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:06,094 - controller.services.websocket_client - INFO - Message type: IRRIGATION_DECISION
2025-09-04 13:19:06,109 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_DECISION', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:06,109 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:06,126 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'current_moisture', 'target_moisture', 'moisture_gap', 'will_irrigate', 'reason', 'session_id']
2025-09-04 13:19:06,136 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:06,188 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:06,215 - controller.services.websocket_client - INFO - Sent IRRIGATION_DECISION message
2025-09-04 13:19:06,396 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:06,413 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:19:06,425 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756981146.3802125, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:06,427 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:06,427 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:19:06,428 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756981146.3802125, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:06,428 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:06,431 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:19:12,026 - controller.services.websocket_client - INFO - Received OPEN_VALVE message
2025-09-04 13:19:12,026 - controller.services.websocket_client - INFO - Full message: {"type":"OPEN_VALVE","data":{"plant_id":219,"time_minutes":15}}
2025-09-04 13:19:12,028 - controller.services.websocket_client - INFO - Parsed data: {'type': 'OPEN_VALVE', 'data': {'plant_id': 219, 'time_minutes': 15}}
2025-09-04 13:19:12,028 - controller.services.websocket_client - INFO - Message type: 'OPEN_VALVE' (length: 10)
2025-09-04 13:19:12,028 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219, 'time_minutes': 15}
2025-09-04 13:19:12,029 - controller.services.websocket_client - INFO - Received OPEN_VALVE request for plant 219, duration: 15 minutes
2025-09-04 13:19:12,035 - controller.services.websocket_client - INFO - === OPEN_VALVE RESPONSE DEBUG ===
2025-09-04 13:19:12,035 - controller.services.websocket_client - INFO - Result status: success
2025-09-04 13:19:12,036 - controller.services.websocket_client - INFO - Result reason: Valve opened for plant 219 for 15 minutes
2025-09-04 13:19:12,036 - controller.services.websocket_client - INFO - Result error_message: None
2025-09-04 13:19:12,036 - controller.services.websocket_client - INFO - Response data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 13:19:12,036 - controller.services.websocket_client - INFO - Response data values: {'plant_id': 219, 'time_minutes': 15, 'status': 'success', 'timestamp': 1756981152.035036, 'message': 'Valve opened for plant 219 for 15 minutes', 'reason': 'Valve opened for plant 219 for 15 minutes'}
2025-09-04 13:19:12,036 - controller.services.websocket_client - INFO - ====================================
2025-09-04 13:19:12,036 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:12,037 - controller.services.websocket_client - INFO - Message type: OPEN_VALVE_RESPONSE
2025-09-04 13:19:12,037 - controller.services.websocket_client - INFO - Full message: {'type': 'OPEN_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 219, 'time_minutes': 15, 'status': 'success', 'timestamp': 1756981152.035036, 'message': 'Valve opened for plant 219 for 15 minutes', 'reason': 'Valve opened for plant 219 for 15 minutes'}}
2025-09-04 13:19:12,037 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:12,037 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'time_minutes', 'status', 'timestamp', 'message', 'reason']
2025-09-04 13:19:12,037 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 219, 'time_minutes': 15, 'status': 'success', 'timestamp': 1756981152.035036, 'message': 'Valve opened for plant 219 for 15 minutes', 'reason': 'Valve opened for plant 219 for 15 minutes'}
2025-09-04 13:19:12,038 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:12,038 - controller.services.websocket_client - INFO - Sent OPEN_VALVE_RESPONSE message
2025-09-04 13:19:12,038 - controller.services.websocket_client - INFO - Open valve request completed for plant 219: success
2025-09-04 13:19:16,462 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:16,463 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:19:16,463 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756981156.4621086, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:16,463 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:16,463 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:19:16,463 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756981156.4621086, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:16,464 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:16,464 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:19:16,934 - controller.services.websocket_client - INFO - Received CLOSE_VALVE message
2025-09-04 13:19:16,935 - controller.services.websocket_client - INFO - Full message: {"type":"CLOSE_VALVE","data":{"plant_id":219}}
2025-09-04 13:19:16,935 - controller.services.websocket_client - INFO - Parsed data: {'type': 'CLOSE_VALVE', 'data': {'plant_id': 219}}
2025-09-04 13:19:16,935 - controller.services.websocket_client - INFO - Message type: 'CLOSE_VALVE' (length: 11)
2025-09-04 13:19:16,935 - controller.services.websocket_client - INFO - Message data: {'plant_id': 219}
2025-09-04 13:19:16,936 - controller.services.websocket_client - INFO - Received CLOSE_VALVE request for plant 219
2025-09-04 13:19:16,938 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:16,938 - controller.services.websocket_client - INFO - Message type: CLOSE_VALVE_RESPONSE
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - Full message: {'type': 'CLOSE_VALVE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}}
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - Message data values: {'type': 'CLOSE_VALVE_RESPONSE', 'data': {'plant_id': 219, 'status': 'success', 'message': 'Valve 1 closed successfully', 'error_message': None}}
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - Sent CLOSE_VALVE_RESPONSE message
2025-09-04 13:19:16,939 - controller.services.websocket_client - INFO - Successfully closed valve for plant 219
2025-09-04 13:19:19,237 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:19:19,237 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:19:19,239 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:19:19,239 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:19:19,239 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:19,239 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:19:19,239 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:19:19,240 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 219): moisture=30.0%, temperature=25.0
2025-09-04 13:19:19,240 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 1 plants
2025-09-04 13:19:19,240 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:19,241 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:19:19,241 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981159.2402313}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756981159.2402313}}
2025-09-04 13:19:19,241 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:19,242 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:19,242 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 219, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981159.2402313}], 'total_plants': 1, 'status': 'success', 'error_message': None, 'timestamp': 1756981159.2402313}
2025-09-04 13:19:19,242 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:19,242 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:19:19,242 - controller.services.websocket_client - INFO - Successfully sent moisture for 1 plants
2025-09-04 13:19:20,033 - controller.services.websocket_client - INFO - Received STOP_IRRIGATION message
2025-09-04 13:19:20,033 - controller.services.websocket_client - INFO - Full message: {"type":"STOP_IRRIGATION","data":{"plant_id":214,"plant_name":"214"}}
2025-09-04 13:19:20,034 - controller.services.websocket_client - INFO - Parsed data: {'type': 'STOP_IRRIGATION', 'data': {'plant_id': 214, 'plant_name': '214'}}
2025-09-04 13:19:20,034 - controller.services.websocket_client - INFO - Message type: 'STOP_IRRIGATION' (length: 15)
2025-09-04 13:19:20,034 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214, 'plant_name': '214'}
2025-09-04 13:19:22,076 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:22,076 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_RESPONSE
2025-09-04 13:19:22,077 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981162.075304, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}}
2025-09-04 13:19:22,077 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:22,077 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'reason', 'moisture', 'final_moisture', 'water_added_liters', 'error_message', 'timestamp', 'session_id']
2025-09-04 13:19:22,077 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981162.075304, 'session_id': '03a85c01-f50a-4226-89f7-b9a0deb7d43d'}
2025-09-04 13:19:22,078 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:22,078 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_RESPONSE message
2025-09-04 13:19:22,078 - controller.services.websocket_client - INFO - Sent irrigation result for plant 214: success
2025-09-04 13:19:22,081 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:22,081 - controller.services.websocket_client - INFO - Message type: STOP_IRRIGATION_RESPONSE
2025-09-04 13:19:22,081 - controller.services.websocket_client - INFO - Full message: {'type': 'STOP_IRRIGATION_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 214, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981162.0806937}}}
2025-09-04 13:19:22,083 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:22,083 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:19:22,083 - controller.services.websocket_client - INFO - Message data values: {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 214, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981162.0806937}}
2025-09-04 13:19:22,083 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:22,084 - controller.services.websocket_client - INFO - Sent STOP_IRRIGATION_RESPONSE message
2025-09-04 13:19:22,084 - controller.services.websocket_client - INFO - STOP IRRIGATION SUCCESS: plant=214 final_moisture=30.0 water_added=0.0
2025-09-04 13:19:25,141 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:19:25,141 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:19:25,141 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:19:25,143 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:19:25,143 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:25,143 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:19:25,143 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:19:25,143 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:19:25,144 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:19:25,144 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:19:25,144 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:25,144 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:19:25,144 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981165.1433666}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981165.1433666}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981165.1447356}}
2025-09-04 13:19:25,145 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:25,145 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:25,145 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981165.1433666}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981165.1433666}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981165.1447356}
2025-09-04 13:19:25,145 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:25,146 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:19:25,146 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:19:27,816 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:19:27,816 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:19:27,816 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:19:32,818 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:19:32,818 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:19:32,818 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:19:32,819 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:19:32,828 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:19:32,829 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:32,829 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:19:33,843 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:19:33,843 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:19:33,843 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:19:33,843 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:19:33,843 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:33,843 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:19:33,844 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:19:33,844 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:33,844 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:19:33,844 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:19:33,844 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:33,845 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:19:33,845 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:19:33,845 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:19:34,856 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:19:34,856 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:19:34,857 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:19:34,857 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:19:34,857 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:19:34,857 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:19:34,857 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:19:34,858 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:19:34,858 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:19:34,858 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:19:34,858 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:19:34,858 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:19:34,859 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:19:34,859 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:19:34,859 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:19:34,859 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:19:34,860 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:19:34,860 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:34,860 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:19:34,860 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:19:34,860 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:19:34,861 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:19:34,862 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:19:34,862 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:19:34,862 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:19:34,863 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:19:34,863 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:19:34,863 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:19:34,865 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:19:34,866 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:19:34,866 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:34,866 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:19:34,866 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:19:34,866 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:19:34,866 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:19:34,866 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:19:47,208 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:19:47,208 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:19:47,209 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:19:47,209 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:19:47,209 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:47,209 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:19:47,209 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:19:47,210 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:19:47,210 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:19:47,210 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:19:47,210 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:47,210 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:19:47,210 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981187.2099102}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981187.2109122}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981187.2109122}}
2025-09-04 13:19:47,212 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:47,212 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:47,212 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981187.2099102}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981187.2109122}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981187.2109122}
2025-09-04 13:19:47,212 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:47,213 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:19:47,213 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:19:51,891 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:19:51,892 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":214}}
2025-09-04 13:19:51,893 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 214}}
2025-09-04 13:19:51,893 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:19:51,893 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214}
2025-09-04 13:19:51,894 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:19:51,894 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 214
2025-09-04 13:19:51,895 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 214 directly from server
2025-09-04 13:19:51,895 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 214: moisture=30.0%, temperature=25.0
2025-09-04 13:19:51,897 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:51,897 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:19:51,898 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981191.895746}}
2025-09-04 13:19:51,898 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:51,899 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:51,899 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981191.895746}
2025-09-04 13:19:51,899 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:51,900 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:19:51,900 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 214 = 30.0%
2025-09-04 13:19:53,225 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:19:53,226 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:19:53,226 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:19:53,227 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:19:53,228 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:19:53,228 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:19:53,229 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:19:53,230 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:19:53,230 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:19:53,231 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:19:53,231 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:19:53,232 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:19:53,232 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981193.2303524}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981193.2303524}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981193.2315352}}
2025-09-04 13:19:53,233 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:19:53,233 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:19:53,235 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981193.2303524}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981193.2303524}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981193.2315352}
2025-09-04 13:19:53,235 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:19:53,236 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:19:53,237 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:19:57,826 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:19:57,826 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:19:57,826 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:20:02,840 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:20:02,840 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:20:02,841 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:20:02,841 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:20:02,844 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:20:02,845 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:02,845 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:20:02,845 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:20:02,845 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:20:02,845 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:20:02,845 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:20:02,847 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:02,847 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:20:03,862 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: PALM89
2025-09-04 13:20:03,862 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:20:03,863 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: PALM89
2025-09-04 13:20:03,863 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:20:03,863 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:03,863 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:20:03,864 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'PALM89'}}
2025-09-04 13:20:03,864 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:20:03,864 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:20:03,865 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'PALM89'}
2025-09-04 13:20:03,865 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:03,865 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:20:03,866 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: PALM89
2025-09-04 13:20:03,866 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:20:04,883 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:20:04,883 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:20:04,884 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:20:04,884 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:20:04,884 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:20:04,885 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:20:04,885 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:20:04,886 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:20:04,886 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:20:04,886 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:20:04,886 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:20:04,886 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:20:04,887 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:20:04,887 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:20:04,887 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:20:04,888 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:20:04,888 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:20:04,888 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:20:04,890 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:20:04,890 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:20:04,890 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":212}}
2025-09-04 13:20:04,890 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 212}}
2025-09-04 13:20:04,891 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:20:04,891 - controller.services.websocket_client - INFO - Message data: {'plant_id': 212}
2025-09-04 13:20:04,891 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:20:04,892 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 212
2025-09-04 13:20:04,892 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 212 directly from server
2025-09-04 13:20:04,892 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 212: moisture=30.0%, temperature=25.0
2025-09-04 13:20:04,892 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:04,893 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:20:04,893 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981204.8920114}}
2025-09-04 13:20:04,893 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:20:04,893 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:20:04,894 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981204.8920114}
2025-09-04 13:20:04,894 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:04,894 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:20:04,894 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 212 = 30.0%
2025-09-04 13:20:04,895 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:20:04,895 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"Ashurov","invite_code":"PALM89"},"plants":[{"plant_id":214,"desiredMoisture":60,"waterLimit":0.6,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}},{"plant_id":212,"desiredMoisture":60,"waterLimit":0.1,"dripperType":"8L/h","sensor_port":"/dev/ttyUSB1","valve_id":"2","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}}]}
2025-09-04 13:20:04,895 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:20:04,897 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:20:04,897 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:20:04,897 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:20:04,897 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:20:04,898 - controller.services.websocket_client - INFO - Garden: Ashurov (Code: PALM89)
2025-09-04 13:20:04,900 - controller.services.websocket_client - INFO - Plants to sync: 2
2025-09-04 13:20:04,900 - controller.services.websocket_client - INFO - Adding plant 214 to engine:
2025-09-04 13:20:04,900 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:20:04,900 - controller.services.websocket_client - INFO -   - Water Limit: 0.6L
2025-09-04 13:20:04,900 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:20:04,901 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:20:04,901 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:20:04,901 - controller.services.websocket_client - ERROR - EROR- Failed to add plant 214: No available valves
2025-09-04 13:20:04,902 - controller.services.websocket_client - INFO - Adding plant 212 to engine:
2025-09-04 13:20:04,903 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:20:04,903 - controller.services.websocket_client - INFO -   - Water Limit: 0.1L
2025-09-04 13:20:04,903 - controller.services.websocket_client - INFO -   - Dripper Type: 8L/h
2025-09-04 13:20:04,903 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:20:04,904 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:20:04,904 - controller.services.websocket_client - ERROR - EROR- Failed to add plant 212: No available valves
2025-09-04 13:20:04,904 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:20:04,904 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-04 13:20:04,904 - controller.services.websocket_client - INFO -   - Plant 214: 60.0% target moisture
2025-09-04 13:20:04,905 - controller.services.websocket_client - INFO -   - Plant 212: 60.0% target moisture
2025-09-04 13:20:04,905 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:20:04,905 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:20:04,905 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:20:04,907 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:20:04,907 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:20:04,907 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:20:04,907 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:20:04,908 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:20:04,908 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:20:04,908 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:20:46,566 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:20:46,568 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":212}}
2025-09-04 13:20:46,568 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 212}}
2025-09-04 13:20:46,569 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:20:46,569 - controller.services.websocket_client - INFO - Message data: {'plant_id': 212}
2025-09-04 13:20:46,569 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:20:46,570 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 212
2025-09-04 13:20:46,570 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 212 directly from server
2025-09-04 13:20:46,570 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 212: moisture=30.0%, temperature=25.0
2025-09-04 13:20:46,571 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:46,571 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:20:46,571 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981246.5702574}}
2025-09-04 13:20:46,571 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:20:46,573 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:20:46,573 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981246.5702574}
2025-09-04 13:20:46,573 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:46,574 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:20:46,575 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 212 = 30.0%
2025-09-04 13:20:47,790 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:20:47,790 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:20:47,790 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:20:47,791 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:20:47,791 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:20:47,791 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:20:47,791 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:20:47,793 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:20:47,793 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:20:47,793 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:20:47,794 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:47,794 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:20:47,794 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981247.7933555}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981247.7933555}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981247.7944903}}
2025-09-04 13:20:47,795 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:20:47,795 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:20:47,795 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981247.7933555}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981247.7933555}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981247.7944903}
2025-09-04 13:20:47,795 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:47,796 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:20:47,796 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:20:56,764 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:20:56,764 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:20:56,765 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:20:56,765 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:20:56,765 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:20:56,765 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:20:56,765 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:20:56,766 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:20:56,766 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:20:56,767 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:20:56,767 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:56,767 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:20:56,768 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981256.7669296}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981256.7669296}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981256.7679324}}
2025-09-04 13:20:56,768 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:20:56,768 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:20:56,770 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981256.7669296}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981256.7669296}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981256.7679324}
2025-09-04 13:20:56,770 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:56,771 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:20:56,772 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:20:57,829 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:20:57,829 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:20:57,829 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:20:58,597 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE message
2025-09-04 13:20:58,598 - controller.services.websocket_client - INFO - Full message: {"type":"GET_PLANT_MOISTURE","data":{"plant_id":214}}
2025-09-04 13:20:58,598 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_PLANT_MOISTURE', 'data': {'plant_id': 214}}
2025-09-04 13:20:58,599 - controller.services.websocket_client - INFO - Message type: 'GET_PLANT_MOISTURE' (length: 18)
2025-09-04 13:20:58,600 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214}
2025-09-04 13:20:58,600 - controller.services.websocket_client - INFO - Received GET_PLANT_MOISTURE command from server
2025-09-04 13:20:58,600 - controller.handlers.get_plant_moisture_handler - INFO - Getting moisture data for single plant: 214
2025-09-04 13:20:58,601 - controller.handlers.get_plant_moisture_handler - INFO - Using plant_id 214 directly from server
2025-09-04 13:20:58,602 - controller.handlers.get_plant_moisture_handler - INFO - Successfully retrieved sensor data for plant 214: moisture=30.0%, temperature=25.0
2025-09-04 13:20:58,602 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:20:58,603 - controller.services.websocket_client - INFO - Message type: PLANT_MOISTURE_RESPONSE
2025-09-04 13:20:58,603 - controller.services.websocket_client - INFO - Full message: {'type': 'PLANT_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981258.60235}}
2025-09-04 13:20:58,604 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:20:58,604 - controller.services.websocket_client - INFO - Message data keys: ['event', 'plant_id', 'moisture', 'temperature', 'status', 'error_message', 'timestamp']
2025-09-04 13:20:58,604 - controller.services.websocket_client - INFO - Message data values: {'event': 'plant_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981258.60235}
2025-09-04 13:20:58,605 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:20:58,607 - controller.services.websocket_client - INFO - Sent PLANT_MOISTURE_RESPONSE message
2025-09-04 13:20:58,607 - controller.services.websocket_client - INFO - Successfully sent plant moisture: Plant 214 = 30.0%
2025-09-04 13:21:00,288 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT message
2025-09-04 13:21:00,288 - controller.services.websocket_client - INFO - Full message: {"type":"IRRIGATE_PLANT","data":{"plant_id":214,"session_id":"cfe49cd3-3890-4862-a54b-5d7ea6a282ac"}}
2025-09-04 13:21:00,289 - controller.services.websocket_client - INFO - Parsed data: {'type': 'IRRIGATE_PLANT', 'data': {'plant_id': 214, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}}
2025-09-04 13:21:00,289 - controller.services.websocket_client - INFO - Message type: 'IRRIGATE_PLANT' (length: 14)
2025-09-04 13:21:00,289 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}
2025-09-04 13:21:00,289 - controller.services.websocket_client - INFO - Received IRRIGATE_PLANT request for plant 214
2025-09-04 13:21:00,290 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:00,290 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_ACCEPTED
2025-09-04 13:21:00,290 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_ACCEPTED', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}}
2025-09-04 13:21:00,290 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:00,290 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'session_id']
2025-09-04 13:21:00,291 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}
2025-09-04 13:21:00,291 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:00,291 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_ACCEPTED message
2025-09-04 13:21:00,291 - controller.services.websocket_client - INFO - Started background irrigation task for plant 214
2025-09-04 13:21:00,293 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:00,293 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:21:00,293 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 42.0%)', 'details': None, 'timestamp': 1756981260.2934697, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}}
2025-09-04 13:21:00,293 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:00,293 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:21:00,294 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'stage': 'initial_check', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': 'Initial moisture check: 30.0% (target: 42.0%)', 'details': None, 'timestamp': 1756981260.2934697, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}
2025-09-04 13:21:00,294 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:00,294 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:21:00,295 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:21:00,297 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: IRRIGATE_PLANT_ACCEPTED"}
2025-09-04 13:21:00,298 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: IRRIGATE_PLANT_ACCEPTED'}
2025-09-04 13:21:00,299 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:21:00,299 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:00,299 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:21:00,299 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:21:00,299 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:21:00,299 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:21:00,299 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:21:00,994 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:00,994 - controller.services.websocket_client - INFO - Message type: IRRIGATION_DECISION
2025-09-04 13:21:00,995 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_DECISION', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}}
2025-09-04 13:21:00,996 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:00,996 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'current_moisture', 'target_moisture', 'moisture_gap', 'will_irrigate', 'reason', 'session_id']
2025-09-04 13:21:00,996 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': 12.0, 'will_irrigate': True, 'reason': 'moisture_below_target', 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}
2025-09-04 13:21:00,997 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:00,998 - controller.services.websocket_client - INFO - Sent IRRIGATION_DECISION message
2025-09-04 13:21:01,001 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:01,001 - controller.services.websocket_client - INFO - Message type: IRRIGATION_PROGRESS
2025-09-04 13:21:01,002 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATION_PROGRESS', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756981261.0002418, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}}
2025-09-04 13:21:01,003 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:01,003 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'stage', 'pulse_number', 'current_moisture', 'target_moisture', 'moisture_gap', 'total_water_used', 'water_limit', 'status', 'message', 'details', 'timestamp', 'session_id']
2025-09-04 13:21:01,004 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'stage': 'update', 'pulse_number': None, 'current_moisture': 30.0, 'target_moisture': 42.0, 'moisture_gap': None, 'total_water_used': None, 'water_limit': None, 'status': 'in_progress', 'message': None, 'details': None, 'timestamp': 1756981261.0002418, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}
2025-09-04 13:21:01,005 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:01,005 - controller.services.websocket_client - INFO - Sent IRRIGATION_PROGRESS message
2025-09-04 13:21:02,837 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:21:02,837 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:21:02,837 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:21:02,837 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:21:02,842 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:21:02,842 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:02,842 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:21:02,843 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:21:02,843 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:21:02,843 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:21:02,843 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:21:02,843 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:02,843 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:21:03,379 - controller.services.websocket_client - INFO - Received STOP_IRRIGATION message
2025-09-04 13:21:03,380 - controller.services.websocket_client - INFO - Full message: {"type":"STOP_IRRIGATION","data":{"plant_id":214,"plant_name":"214"}}
2025-09-04 13:21:03,381 - controller.services.websocket_client - INFO - Parsed data: {'type': 'STOP_IRRIGATION', 'data': {'plant_id': 214, 'plant_name': '214'}}
2025-09-04 13:21:03,381 - controller.services.websocket_client - INFO - Message type: 'STOP_IRRIGATION' (length: 15)
2025-09-04 13:21:03,382 - controller.services.websocket_client - INFO - Message data: {'plant_id': 214, 'plant_name': '214'}
2025-09-04 13:21:03,853 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:21:03,853 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:21:03,853 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:21:03,854 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:21:03,854 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:03,855 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:21:03,856 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:21:03,856 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:03,857 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:21:03,857 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:21:03,858 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:03,859 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:21:03,859 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:21:03,859 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:21:04,879 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:21:04,880 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:21:04,880 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:21:04,881 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:21:04,882 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:21:04,882 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:21:04,883 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:21:04,883 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:21:04,884 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:21:04,884 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:21:04,885 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:21:04,886 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:21:04,886 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:21:04,887 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:21:04,888 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:21:04,888 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:21:04,889 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:21:04,889 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:04,890 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:21:04,891 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:21:04,891 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:21:04,892 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:21:04,892 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:21:04,893 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:04,893 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:21:04,894 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:21:04,894 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:21:04,895 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:21:04,895 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:21:04,896 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:21:04,896 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:21:04,897 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:21:04,897 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:21:04,898 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:21:04,900 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:21:04,900 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:21:04,902 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:21:04,902 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:21:04,902 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:21:04,903 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:21:04,903 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:21:04,904 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:21:04,904 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:04,905 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:21:04,905 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:21:04,905 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:21:04,906 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:21:04,906 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:21:05,407 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:05,407 - controller.services.websocket_client - INFO - Message type: IRRIGATE_PLANT_RESPONSE
2025-09-04 13:21:05,407 - controller.services.websocket_client - INFO - Full message: {'type': 'IRRIGATE_PLANT_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plant_id': 214, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981265.4071755, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}}
2025-09-04 13:21:05,407 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:05,407 - controller.services.websocket_client - INFO - Message data keys: ['plant_id', 'status', 'reason', 'moisture', 'final_moisture', 'water_added_liters', 'error_message', 'timestamp', 'session_id']
2025-09-04 13:21:05,408 - controller.services.websocket_client - INFO - Message data values: {'plant_id': 214, 'status': 'success', 'reason': None, 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981265.4071755, 'session_id': 'cfe49cd3-3890-4862-a54b-5d7ea6a282ac'}
2025-09-04 13:21:05,408 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:05,408 - controller.services.websocket_client - INFO - Sent IRRIGATE_PLANT_RESPONSE message
2025-09-04 13:21:05,408 - controller.services.websocket_client - INFO - Sent irrigation result for plant 214: success
2025-09-04 13:21:05,409 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:05,409 - controller.services.websocket_client - INFO - Message type: STOP_IRRIGATION_RESPONSE
2025-09-04 13:21:05,409 - controller.services.websocket_client - INFO - Full message: {'type': 'STOP_IRRIGATION_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 214, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981265.409468}}}
2025-09-04 13:21:05,409 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:05,410 - controller.services.websocket_client - INFO - Message data keys: ['type', 'data']
2025-09-04 13:21:05,410 - controller.services.websocket_client - INFO - Message data values: {'type': 'STOP_IRRIGATION_RESPONSE', 'data': {'event': 'stop_irrigation_response', 'plant_id': 214, 'status': 'success', 'moisture': 30.0, 'final_moisture': 30.0, 'water_added_liters': 0.0, 'error_message': None, 'timestamp': 1756981265.409468}}
2025-09-04 13:21:05,410 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:05,410 - controller.services.websocket_client - INFO - Sent STOP_IRRIGATION_RESPONSE message
2025-09-04 13:21:05,411 - controller.services.websocket_client - INFO - STOP IRRIGATION SUCCESS: plant=214 final_moisture=30.0 water_added=0.0
2025-09-04 13:21:07,927 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE message
2025-09-04 13:21:07,928 - controller.services.websocket_client - INFO - Full message: {"type":"GET_ALL_MOISTURE","data":{}}
2025-09-04 13:21:07,928 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GET_ALL_MOISTURE', 'data': {}}
2025-09-04 13:21:07,929 - controller.services.websocket_client - INFO - Message type: 'GET_ALL_MOISTURE' (length: 16)
2025-09-04 13:21:07,929 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:07,930 - controller.services.websocket_client - INFO - Received GET_ALL_MOISTURE command from server
2025-09-04 13:21:07,930 - controller.handlers.get_all_plants_moisture_handler - INFO - Getting moisture data for all plants
2025-09-04 13:21:07,931 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 214): moisture=30.0%, temperature=25.0
2025-09-04 13:21:07,931 - controller.handlers.get_all_plants_moisture_handler - INFO - Plant (internal 212): moisture=30.0%, temperature=25.0
2025-09-04 13:21:07,933 - controller.handlers.get_all_plants_moisture_handler - INFO - Successfully retrieved sensor data for 2 plants
2025-09-04 13:21:07,933 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:07,934 - controller.services.websocket_client - INFO - Message type: ALL_MOISTURE_RESPONSE
2025-09-04 13:21:07,934 - controller.services.websocket_client - INFO - Full message: {'type': 'ALL_MOISTURE_RESPONSE', 'device_id': 'raspberrypi_main_controller', 'data': {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981267.931833}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981267.931833}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981267.933345}}
2025-09-04 13:21:07,935 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:07,935 - controller.services.websocket_client - INFO - Message data keys: ['plants', 'total_plants', 'status', 'error_message', 'timestamp']
2025-09-04 13:21:07,936 - controller.services.websocket_client - INFO - Message data values: {'plants': [{'event': 'all_plants_moisture_update', 'plant_id': 214, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981267.931833}, {'event': 'all_plants_moisture_update', 'plant_id': 212, 'moisture': 30.0, 'temperature': 25.0, 'status': 'success', 'error_message': None, 'timestamp': 1756981267.931833}], 'total_plants': 2, 'status': 'success', 'error_message': None, 'timestamp': 1756981267.933345}
2025-09-04 13:21:07,936 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:07,936 - controller.services.websocket_client - INFO - Sent ALL_MOISTURE_RESPONSE message
2025-09-04 13:21:07,937 - controller.services.websocket_client - INFO - Successfully sent moisture for 2 plants
2025-09-04 13:21:27,831 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:21:27,831 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:21:27,833 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:21:32,841 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:21:32,842 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:21:32,842 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:21:32,843 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:21:32,845 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:21:32,845 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:32,845 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:21:32,845 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:21:32,846 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:21:32,846 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:21:32,846 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:21:32,846 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:32,847 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:21:33,854 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: PALM89
2025-09-04 13:21:33,854 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:21:33,854 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: PALM89
2025-09-04 13:21:33,854 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:21:33,854 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:21:33,854 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'PALM89'}}
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'PALM89'}
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:21:33,855 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: PALM89
2025-09-04 13:21:33,857 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:21:34,865 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:21:34,865 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:21:34,865 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:21:34,865 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:21:34,865 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:21:34,865 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:21:34,866 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"Ashurov","invite_code":"PALM89"},"plants":[{"plant_id":214,"desiredMoisture":60,"waterLimit":0.6,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}},{"plant_id":212,"desiredMoisture":60,"waterLimit":0.1,"dripperType":"8L/h","sensor_port":"/dev/ttyUSB1","valve_id":"2","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}}]}
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:21:34,867 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO - Garden: Ashurov (Code: PALM89)
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO - Plants to sync: 2
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO - Adding plant 214 to engine:
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:21:34,868 - controller.services.websocket_client - INFO -   - Water Limit: 0.6L
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:21:34,869 - controller.services.websocket_client - ERROR - EROR- Failed to add plant 214: No available valves
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO - Adding plant 212 to engine:
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Water Limit: 0.1L
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Dripper Type: 8L/h
2025-09-04 13:21:34,869 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:21:34,870 - controller.services.websocket_client - ERROR - EROR- Failed to add plant 212: No available valves
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO -   - Plant 214: 60.0% target moisture
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO -   - Plant 212: 60.0% target moisture
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:21:34,870 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:21:34,871 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:21:34,871 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:21:34,871 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:21:34,871 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:21:34,871 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:21:34,871 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:21:34,871 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:22:27,836 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:22:27,836 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:22:27,837 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:22:32,850 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:22:32,851 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:22:32,851 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:22:32,852 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:22:32,856 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:22:32,861 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:22:32,862 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:22:32,862 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:22:32,862 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:22:32,862 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:22:32,863 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:22:32,863 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:22:32,863 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:22:33,877 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: IRIS12
2025-09-04 13:22:33,877 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:22:33,877 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: IRIS12
2025-09-04 13:22:33,878 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:22:33,878 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:22:33,878 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:22:33,878 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'IRIS12'}}
2025-09-04 13:22:33,878 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:22:33,878 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:22:33,879 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'IRIS12'}
2025-09-04 13:22:33,879 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:22:33,879 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:22:33,879 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: IRIS12
2025-09-04 13:22:33,879 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:22:34,887 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:22:34,887 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:22:34,888 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:22:34,888 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:22:34,888 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:22:34,888 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:22:34,889 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:22:34,889 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:22:34,890 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:22:34,890 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:22:34,890 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:22:34,890 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:22:34,891 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:22:34,891 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:22:34,891 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:22:34,892 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:22:34,892 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:22:34,892 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:22:34,893 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:22:34,893 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:22:34,893 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"TLV","invite_code":"IRIS12"},"plants":[{"plant_id":219,"desiredMoisture":55,"waterLimit":1,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":31.7977314,"lon":34.6529922,"scheduleData":{"irrigation_days":["Sun"],"irrigation_time":"12:28:00"}}]}
2025-09-04 13:22:34,893 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:22:34,895 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:22:34,895 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:22:34,895 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:22:34,895 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'TLV', 'invite_code': 'IRIS12'}, 'plants': [{'plant_id': 219, 'desiredMoisture': 55, 'waterLimit': 1, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 31.7977314, 'lon': 34.6529922, 'scheduleData': {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}}]}
2025-09-04 13:22:34,895 - controller.services.websocket_client - INFO - Garden: TLV (Code: IRIS12)
2025-09-04 13:22:34,895 - controller.services.websocket_client - INFO - Plants to sync: 1
2025-09-04 13:22:34,896 - controller.services.websocket_client - INFO - Adding plant 219 to engine:
2025-09-04 13:22:34,896 - controller.services.websocket_client - INFO -   - Desired Moisture: 55.0%
2025-09-04 13:22:34,896 - controller.services.websocket_client - INFO -   - Water Limit: 1.0L
2025-09-04 13:22:34,896 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:22:34,896 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': ['Sun'], 'irrigation_time': '12:28:00'}
2025-09-04 13:22:34,897 - controller.services.websocket_client - INFO -   - Lat/Lon: 31.7977314,34.6529922
2025-09-04 13:22:34,897 - controller.services.websocket_client - INFO - Successfully added plant 219 to engine
2025-09-04 13:22:34,897 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO - Total plants in engine: 1
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO -   - Plant 219: 55.0% target moisture
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:22:34,898 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:22:34,900 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:22:34,900 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:22:34,900 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:22:34,900 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:22:34,901 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:22:57,841 - controller.services.websocket_client - WARNING - Connection closed by server
2025-09-04 13:22:57,842 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:22:57,842 - controller.run_pi_client - WARNING - Connection lost. Retrying in 5 seconds...
2025-09-04 13:23:02,848 - controller.run_pi_client - INFO - === Starting Smart Garden WebSocket Client ===
2025-09-04 13:23:02,848 - controller.run_pi_client - INFO - Connecting to server using existing engine instance
2025-09-04 13:23:02,849 - controller.services.websocket_client - INFO - Smart Garden Pi Client Starting...
2025-09-04 13:23:02,849 - controller.services.websocket_client - INFO - Connecting to WebSocket server: ws://192.168.68.67:8080
2025-09-04 13:23:02,855 - controller.services.websocket_client - INFO - Successfully connected to server!
2025-09-04 13:23:02,856 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:23:02,856 - controller.services.websocket_client - INFO - Message type: HELLO_PI
2025-09-04 13:23:02,856 - controller.services.websocket_client - INFO - Full message: {'type': 'HELLO_PI', 'device_id': 'raspberrypi_main_controller'}
2025-09-04 13:23:02,857 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id']
2025-09-04 13:23:02,857 - controller.services.websocket_client - INFO - Message data keys: No data
2025-09-04 13:23:02,858 - controller.services.websocket_client - INFO - Message data values: None
2025-09-04 13:23:02,859 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:23:02,860 - controller.services.websocket_client - INFO - Sent HELLO_PI message
2025-09-04 13:23:03,874 - controller.services.websocket_client - INFO - Sending PI_CONNECT with family code: PALM89
2025-09-04 13:23:03,874 - controller.services.websocket_client - INFO - === SENDING PI_CONNECT ===
2025-09-04 13:23:03,875 - controller.services.websocket_client - INFO - Attempting to connect to garden with invite code: PALM89
2025-09-04 13:23:03,875 - controller.services.websocket_client - INFO - Sending PI_CONNECT message to server...
2025-09-04 13:23:03,876 - controller.services.websocket_client - INFO - === SENDING MESSAGE DEBUG ===
2025-09-04 13:23:03,876 - controller.services.websocket_client - INFO - Message type: PI_CONNECT
2025-09-04 13:23:03,877 - controller.services.websocket_client - INFO - Full message: {'type': 'PI_CONNECT', 'device_id': 'raspberrypi_main_controller', 'data': {'family_code': 'PALM89'}}
2025-09-04 13:23:03,877 - controller.services.websocket_client - INFO - Message keys: ['type', 'device_id', 'data']
2025-09-04 13:23:03,879 - controller.services.websocket_client - INFO - Message data keys: ['family_code']
2025-09-04 13:23:03,879 - controller.services.websocket_client - INFO - Message data values: {'family_code': 'PALM89'}
2025-09-04 13:23:03,880 - controller.services.websocket_client - INFO - =============================
2025-09-04 13:23:03,881 - controller.services.websocket_client - INFO - Sent PI_CONNECT message
2025-09-04 13:23:03,881 - controller.services.websocket_client - INFO - PI_CONNECT message sent successfully with family code: PALM89
2025-09-04 13:23:03,882 - controller.services.websocket_client - INFO - Waiting for GARDEN_SYNC response from server...
2025-09-04 13:23:04,895 - controller.services.websocket_client - INFO - Client is ready and listening for commands...
2025-09-04 13:23:04,895 - controller.services.websocket_client - INFO - Supported commands:
2025-09-04 13:23:04,896 - controller.services.websocket_client - INFO -   - WELCOME: Server welcome message
2025-09-04 13:23:04,897 - controller.services.websocket_client - INFO -   - ADD_PLANT: Add a new plant to the system
2025-09-04 13:23:04,897 - controller.services.websocket_client - INFO -   - GET_PLANT_MOISTURE: Get moisture for a specific plant
2025-09-04 13:23:04,898 - controller.services.websocket_client - INFO -   - GET_ALL_MOISTURE: Get moisture for all plants
2025-09-04 13:23:04,898 - controller.services.websocket_client - INFO -   - IRRIGATE_PLANT: Smart irrigation for a specific plant
2025-09-04 13:23:04,899 - controller.services.websocket_client - INFO -   - STOP_IRRIGATION: Stop smart irrigation for a specific plant
2025-09-04 13:23:04,900 - controller.services.websocket_client - INFO -   - OPEN_VALVE: Open valve for a specific plant for a given duration
2025-09-04 13:23:04,900 - controller.services.websocket_client - INFO -   - CLOSE_VALVE: Close valve for a specific plant
2025-09-04 13:23:04,901 - controller.services.websocket_client - INFO -   - GET_VALVE_STATUS: Get detailed valve status for a specific plant
2025-09-04 13:23:04,901 - controller.services.websocket_client - INFO -   - UPDATE_PLANT: Update an existing plant's configuration
2025-09-04 13:23:04,902 - controller.services.websocket_client - INFO -   - GARDEN_SYNC: Sync garden and plants data from server
2025-09-04 13:23:04,902 - controller.services.websocket_client - INFO - Received WELCOME message
2025-09-04 13:23:04,903 - controller.services.websocket_client - INFO - Full message: {"type":"WELCOME","message":"Hello Pi"}
2025-09-04 13:23:04,903 - controller.services.websocket_client - INFO - Parsed data: {'type': 'WELCOME', 'message': 'Hello Pi'}
2025-09-04 13:23:04,905 - controller.services.websocket_client - INFO - Message type: 'WELCOME' (length: 7)
2025-09-04 13:23:04,905 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:23:04,906 - controller.services.websocket_client - INFO - Received welcome message from server
2025-09-04 13:23:04,907 - controller.services.websocket_client - INFO - Received GARDEN_SYNC message
2025-09-04 13:23:04,907 - controller.services.websocket_client - INFO - Full message: {"type":"GARDEN_SYNC","garden":{"name":"Ashurov","invite_code":"PALM89"},"plants":[{"plant_id":214,"desiredMoisture":60,"waterLimit":0.6,"dripperType":"2L/h","sensor_port":"/dev/ttyUSB0","valve_id":"1","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}},{"plant_id":212,"desiredMoisture":60,"waterLimit":0.1,"dripperType":"8L/h","sensor_port":"/dev/ttyUSB1","valve_id":"2","lat":19.0785451,"lon":72.878176,"scheduleData":{"irrigation_days":null,"irrigation_time":null}}]}
2025-09-04 13:23:04,908 - controller.services.websocket_client - INFO - Parsed data: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:23:04,909 - controller.services.websocket_client - INFO - Message type: 'GARDEN_SYNC' (length: 11)
2025-09-04 13:23:04,909 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:23:04,910 - controller.services.websocket_client - INFO - === HANDLING GARDEN_SYNC ===
2025-09-04 13:23:04,911 - controller.services.websocket_client - INFO - Received garden sync message: {'type': 'GARDEN_SYNC', 'garden': {'name': 'Ashurov', 'invite_code': 'PALM89'}, 'plants': [{'plant_id': 214, 'desiredMoisture': 60, 'waterLimit': 0.6, 'dripperType': '2L/h', 'sensor_port': '/dev/ttyUSB0', 'valve_id': '1', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}, {'plant_id': 212, 'desiredMoisture': 60, 'waterLimit': 0.1, 'dripperType': '8L/h', 'sensor_port': '/dev/ttyUSB1', 'valve_id': '2', 'lat': 19.0785451, 'lon': 72.878176, 'scheduleData': {'irrigation_days': None, 'irrigation_time': None}}]}
2025-09-04 13:23:04,911 - controller.services.websocket_client - INFO - Garden: Ashurov (Code: PALM89)
2025-09-04 13:23:04,912 - controller.services.websocket_client - INFO - Plants to sync: 2
2025-09-04 13:23:04,912 - controller.services.websocket_client - INFO - Adding plant 214 to engine:
2025-09-04 13:23:04,913 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:23:04,913 - controller.services.websocket_client - INFO -   - Water Limit: 0.6L
2025-09-04 13:23:04,913 - controller.services.websocket_client - INFO -   - Dripper Type: 2L/h
2025-09-04 13:23:04,915 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:23:04,915 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:23:04,916 - controller.services.websocket_client - ERROR - EROR- Failed to add plant 214: No available valves
2025-09-04 13:23:04,916 - controller.services.websocket_client - INFO - Adding plant 212 to engine:
2025-09-04 13:23:04,917 - controller.services.websocket_client - INFO -   - Desired Moisture: 60.0%
2025-09-04 13:23:04,917 - controller.services.websocket_client - INFO -   - Water Limit: 0.1L
2025-09-04 13:23:04,918 - controller.services.websocket_client - INFO -   - Dripper Type: 8L/h
2025-09-04 13:23:04,918 - controller.services.websocket_client - INFO -   - Schedule: {'irrigation_days': None, 'irrigation_time': None}
2025-09-04 13:23:04,919 - controller.services.websocket_client - INFO -   - Lat/Lon: 19.0785451,72.878176
2025-09-04 13:23:04,919 - controller.services.websocket_client - ERROR - EROR- Failed to add plant 212: No available valves
2025-09-04 13:23:04,920 - controller.services.websocket_client - INFO - === GARDEN SYNC COMPLETE ===
2025-09-04 13:23:04,920 - controller.services.websocket_client - INFO - Total plants in engine: 2
2025-09-04 13:23:04,921 - controller.services.websocket_client - INFO -   - Plant 214: 60.0% target moisture
2025-09-04 13:23:04,921 - controller.services.websocket_client - INFO -   - Plant 212: 60.0% target moisture
2025-09-04 13:23:04,922 - controller.services.websocket_client - INFO - Received UNKNOWN_TYPE message
2025-09-04 13:23:04,922 - controller.services.websocket_client - INFO - Full message: {"type":"UNKNOWN_TYPE","reason":"Unknown message type: PI_CONNECT"}
2025-09-04 13:23:04,923 - controller.services.websocket_client - INFO - Parsed data: {'type': 'UNKNOWN_TYPE', 'reason': 'Unknown message type: PI_CONNECT'}
2025-09-04 13:23:04,923 - controller.services.websocket_client - INFO - Message type: 'UNKNOWN_TYPE' (length: 12)
2025-09-04 13:23:04,925 - controller.services.websocket_client - INFO - Message data: {}
2025-09-04 13:23:04,925 - controller.services.websocket_client - WARNING - UNKNOWN MESSAGE TYPE: 'UNKNOWN_TYPE' (not in expected list)
2025-09-04 13:23:04,926 - controller.services.websocket_client - WARNING - Expected types: ['WELCOME', 'ADD_PLANT', 'GET_PLANT_MOISTURE', 'GET_ALL_MOISTURE', 'IRRIGATE_PLANT', 'STOP_IRRIGATION', 'OPEN_VALVE', 'CLOSE_VALVE', 'GET_VALVE_STATUS', 'VALVE_STATUS', 'UPDATE_PLANT', 'UPDATE_PLANT_RESPONSE', 'GARDEN_SYNC', 'REMOVE_PLANT', 'RESTART_VALVE']
2025-09-04 13:23:04,926 - controller.services.websocket_client - WARNING - Message type bytes: 'UNKNOWN_TYPE'
2025-09-04 13:23:04,927 - controller.services.websocket_client - WARNING - Message type hex: 554e4b4e4f574e5f54595045
2025-09-04 13:23:04,927 - controller.services.websocket_client - WARNING - Unknown message type: UNKNOWN_TYPE
2025-09-04 13:23:48,995 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 13:23:48,999 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 13:23:49,000 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:23:49,000 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 13:23:49,001 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:23:49,001 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 13:23:49,001 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:23:49,001 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 13:23:53,336 - controller.run_pi_client - INFO - Received signal 2. Shutting down...
2025-09-04 13:23:53,342 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 13:23:53,345 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:23:53,346 - controller.run_pi_client - INFO - Stopping Smart Garden Pi Client...
2025-09-04 13:23:53,347 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:23:53,349 - controller.run_pi_client - INFO - Pi Client stopped successfully
2025-09-04 13:23:53,359 - controller.services.websocket_client - INFO - Disconnected from server
2025-09-04 13:23:53,359 - controller.run_pi_client - INFO - Pi Client stopped successfully
