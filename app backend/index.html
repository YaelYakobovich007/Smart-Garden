<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Smart Garden â€“ Register + Google Login</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <h1>ğŸŒ¿ Smart Garden â€“ Register</h1>

  <h2>ğŸ†• Register with Email</h2>
  <input id="email" type="email" placeholder="Email" />
  <input id="password" type="password" placeholder="Password" />
  <br><br>
  <button onclick="register()">Register</button>

  <hr>

  <h2>ğŸ” Or continue with Google</h2>

  <!-- Google Sign-In -->
  <div id="g_id_onload"
       data-client_id="PASTE_YOUR_CLIENT_ID_HERE"
       data-callback="handleGoogleLogin">
  </div>

  <div class="g_id_signin"
       data-type="standard"
       data-size="large"
       data-theme="outline"
       data-text="continue_with"
       data-shape="rectangular">
  </div>

  <hr>
  <pre id="log"></pre>

  <script>
    const socket = new WebSocket('ws://localhost:8080');

    socket.onopen = () => {
      log('âœ… Connected to server');
    };

    socket.onmessage = (event) => {
      const data = JSON.parse(event.data);
      log('ğŸ“© From server:\n' + JSON.stringify(data, null, 2));
    };

    socket.onclose = () => {
      log('âŒ Disconnected from server');
    };

    socket.onerror = (err) => {
      log('ğŸš« Error: ' + err.message);
    };

    function register() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      if (!email || !password) {
        log('âš ï¸ Please enter both email and password.');
        return;
      }

      socket.send(JSON.stringify({
        type: 'REGISTER',
        email,
        password
      }));
      log('ğŸ“¤ Sent register request');
    }

    function handleGoogleLogin(response) {
      const idToken = response.credential;

      socket.send(JSON.stringify({
        type: 'LOGIN_GOOGLE',
        googleToken: idToken
      }));

      log('ğŸ“¤ Sent Google login token to server');
    }

    function log(msg) {
      document.getElementById('log').textContent += msg + '\n';
    }
  </script>
</body>
</
