<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Test</title>
</head>
<body>
    <h1>WebSocket Connection Test</h1>
    <div id="status">Connecting...</div>
    <div id="messages"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const messagesDiv = document.getElementById('messages');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            messagesDiv.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        log('Attempting to connect to WebSocket server...');
        
        const ws = new WebSocket('ws://192.168.68.54:8080');
        
        ws.onopen = function() {
            statusDiv.textContent = 'Connected!';
            statusDiv.style.color = 'green';
            log('WebSocket connected successfully');
            
            // Send HELLO_USER message
            ws.send(JSON.stringify({ type: 'HELLO_USER' }));
            log('Sent HELLO_USER message');
        };
        
        ws.onmessage = function(event) {
            try {
                const data = JSON.parse(event.data);
                log(`Received: ${JSON.stringify(data)}`);
            } catch (error) {
                log(`Error parsing message: ${error.message}`);
            }
        };
        
        ws.onerror = function(error) {
            statusDiv.textContent = 'Connection Error!';
            statusDiv.style.color = 'red';
            log(`WebSocket error: ${JSON.stringify(error)}`);
        };
        
        ws.onclose = function(event) {
            statusDiv.textContent = 'Disconnected';
            statusDiv.style.color = 'orange';
            log(`WebSocket closed: code=${event.code}, reason=${event.reason}`);
        };
    </script>
</body>
</html> 